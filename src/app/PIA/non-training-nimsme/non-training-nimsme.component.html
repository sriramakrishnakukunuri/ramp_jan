<main class="mt-4">
  <section>
    <div class="container-fluid">
      <div class="card mb-3">
        <div class="card-header bg-transparent">
          <div class="row align-items-center">
            <div class="col-12">
              <h6 class="fw-600 mb-2 mb-sm-3 mb-md-0">Non Training Progress</h6>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12 col-sm-6 col-md-4 col-lg-3">
              <div class="form-floating mb-3 mb-sm-3 mb-md-0">
                <select class="form-select events-expenditure" id="budgethead" [(ngModel)]="selectedActivity"
                  (change)="onActivityChange($any($event.target).value)">
                  <!-- <option value="#">Select Budget Head</option> -->
                  <option *ngFor="let item of budgetHeadList" value="{{item?.activityId}}">{{item?.activityName}}
                  </option>
                  <!-- <option value="1">Preliminary survey for selection of potential SHGs</option>
                                        <option value="2">Dashboard / Central Management System</option> -->
                  <!-- <option value="3">Handholding support</option>
                                        <option value="4">Raw material support</option> -->
                  <!-- <option value="5">Contingency fund</option> -->
                </select>
                <label for="budgethead">Budget Head</label>
              </div>
            </div>
            <div class="col-12 col-sm-6 col-md-4 col-lg-3">
              <div class="form-floating mb-3 mb-sm-3 mb-md-0">
                <select class="form-select events-expenditure" id="budgethead" [(ngModel)]="selectedBudgetHead"
                  (change)="onBudgetHeadChange($any($event.target).value)">
                  <!-- <option value="#">Select Budget Head</option> -->
                  <option *ngFor="let item of SubActivityList" value="{{item?.subActivityId}}">{{item?.subActivityName}}
                  </option>
                  <!-- <option value="1">Preliminary survey for selection of potential SHGs</option>
                                        <option value="2">Dashboard / Central Management System</option> -->
                  <!-- <option value="3">Handholding support</option>
                                        <option value="4">Raw material support</option> -->
                  <!-- <option value="5">Contingency fund</option> -->
                </select>
                <label for="budgethead">Sub Activity</label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card budgets mb-3 " *ngIf="selectedActivity=='20' || selectedActivity=='21' || selectedActivity=='22'|| selectedActivity=='106'">

        <div class="card-header bg-transparent d-flex justify-content-between">
          <h6 class="fw-600 mb-2 mb-sm-3 mb-md-0"> {{getSubactivities(selectedBudgetHead)}} </h6>


          <div class="text-end">
            <button type="button" class="btn btn-sm btn-lime-green" (click)="onFinalSubmit()">Save</button>
          </div>
        </div>
        <div class="card-body">
          <div class="row"
            *ngIf="selectedBudgetHead=='77' || selectedBudgetHead=='78' || selectedBudgetHead=='79' || selectedBudgetHead=='80' || selectedBudgetHead=='81' || selectedBudgetHead=='82' || selectedBudgetHead=='84' || selectedBudgetHead=='83' || selectedBudgetHead=='19'">
            <div class="col-12 col-sm-12 col-md-6 col-lg-6">
              <fieldset class="mb-3" style="border: 1px solid #e0e0e0; border-radius: 8px; padding-left: 18px; ">
                <legend class="text-lime-green" style="padding: 0 8px;">Physical</legend>
                <div class="row mb-2">
                  <div class="col-12 col-sm-6 col-md-6 col-lg-6 p-2">
                    <div class="mb-3">
                      <label class="fs-md fw-600 mb-1 d-block">Physical Target</label>
                      <label class="fs-md fw-600">{{physicalTarget}}</label>
                    </div>
                  </div>
                  <div class="col-12 col-sm-6 col-md-6 col-lg-6" *ngIf="physicalTarget<=1">
                    <div class="form-floating mb-3 mb-sm-3 mb-md-0 px-2">
                      <select class="form-select" id="pt1" [(ngModel)]="physicalTargetAchievement">
                        <option value="">Select Physical Achievement</option>
                        <option value="Not Initiated">Not Initiated</option>
                        <option value="In Progress">In Progress</option>
                        <option value="Completed">Completed</option>
                      </select>
                      <label for="pt1">Physical Achievement</label>
                    </div>
                  </div>
                  <div class="col-12 col-sm-6 col-md-6 col-lg-6 px-2" *ngIf="physicalTarget>1">
                    <div class="form-floating mb-3 mb-sm-3 mb-md-0 px-2">
                      <input type="text" class="form-control" placeholder="" id="physicalTargetAchievement"
                        [(ngModel)]="physicalTargetAchievement">
                      <label for="physicalTargetAchievement">Physical Achievement</label>
                    </div>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="col-12 col-sm-12 col-md-6 col-lg-6">
              <fieldset class="mb-3" style="border: 1px solid #e0e0e0; border-radius: 8px; padding-left: 18px; ">
                <legend class="text-lime-green" style="padding: 0 8px;">Financial</legend>
                <div class="row mb-2">
                  <div class="col-12 col-sm-6 col-md-6 col-lg-6 p-2">
                    <div class="mb-3">
                      <label class="fs-md fw-600 mb-1 d-block">Financial Target</label>
                      <label class="fs-md fw-600">{{financialTarget}}</label>
                    </div>
                  </div>
                  <div class="col-12 col-sm-6 col-md-6 col-lg-6 p-2">
                    <div class="mb-3">
                      <label class="fs-md fw-600 mb-1 d-block">Financial Achievement</label>
                      <label class="fs-md fw-600">{{financialTargetAchievement}}</label>
                    </div>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>

          <!-- Media Upload Section for Budget Heads 77, 78 -->
          <div class="card"
            *ngIf="selectedBudgetHead=='77' || selectedBudgetHead=='78'">
            <div class="card-header bg-transparent">
              <div class="row align-items-center">
                <div class="col-8 col-sm-8 col-md-9 col-lg-10">
                  <h6 class="fw-600 mb-2 mb-sm-3 mb-md-0">Content Upload</h6>
                </div>
                <div class="col-4 col-sm-4 col-md-3 col-lg-2">
                  <div class="text-end">
                    <button type="button" class="btn btn-sm btn-lime-green" (click)="openUploadModal('add')"><span
                        class="bi bi-plus-lg"></span> Add</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <table id="view-Upload" class="table table-bordered nowrap w-100 trainingTable">
                <thead class="bg-lime-green text-white">
                  <tr>
                    <th>S.No</th>
                    <th>{{selectedBudgetHead=='77'?'Video':'Content'}} Name</th>
                    <th>Content Type</th>
                    <th>Topic</th>
                    <th>Duration/Pages</th>
                    <th>Status</th>
                    <th>Date of Upload</th>
                    <!-- <th>Download</th> -->
                    <th class="text-center">Edit / Delete</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngIf="!getUploadData || getUploadData.length === 0">
                    <td colspan="9" class="text-center text-muted">No data available.</td>
                  </tr>
                  <tr *ngFor="let upload of getUploadData; let i = index">
                    <td>{{ i + 1 }}</td>
                    <td>{{ upload?.contentName }}</td>
                    <td>{{ upload?.contentType }}</td>
                    <td>{{ upload?.topic }}</td>
                    <td>{{ upload?.durationOrPages }}</td>
                    <td>
                      <span class="badge"
                        [ngClass]="upload.status === 'Active' ? 'bg-success' : upload.status === 'Pending' ? 'bg-warning' : 'bg-danger'">
                        {{ upload.status }}
                      </span>
                    </td>
                    <td>{{ upload?.dateOfUpload | date: 'dd-MM-yyyy' }}</td>
                    <!-- <td class="text-center">
                      <a [href]="upload?.url" target="_blank" class="btn btn-default text-primary btn-sm"
                        *ngIf="upload?.url">
                        <span class="bi bi-download"></span>
                      </a>
                    </td> -->
                    <td class="text-center">
                      <button type="button" class="btn btn-default text-lime-green btn-sm"
                        (click)="openUploadModal('edit', upload)">
                        <span class="bi bi-pencil"></span>
                      </button>
                      <button type="button" class="btn btn-default text-danger btn-sm"
                        (click)="deleteUpload(upload?.id)">
                        <span class="bi bi-trash"></span>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Vendor Management Section for Budget Heads 79, 80, 81 -->
          <div class="card" *ngIf="selectedBudgetHead=='79' || selectedBudgetHead=='80' || selectedBudgetHead=='81'">
            <div class="card-header bg-transparent">
              <div class="row align-items-center">
                <div class="col-8 col-sm-8 col-md-9 col-lg-10">
                  <h6 class="fw-600 mb-2 mb-sm-3 mb-md-0">Vendor Management</h6>
                </div>
                <div class="col-4 col-sm-4 col-md-3 col-lg-2">
                  <div class="text-end">
                    <button type="button" class="btn btn-sm btn-lime-green" (click)="openVendorModal('add')">
                      <span class="bi bi-plus-lg"></span> Add Vendor
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <table id="view-Vendor" class="table table-bordered nowrap w-100 trainingTable">
                <thead class="bg-lime-green text-white">
                  <tr>
                    <th>S.No</th>
                    <th>Vendor Company Name</th>
                    <th>Date of Order</th>
                    <th>Order Details</th>
                    <th class="text-center">Edit / Delete</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngIf="!getVendorData || getVendorData.length === 0">
                    <td colspan="5" class="text-center text-muted">No vendor data available.</td>
                  </tr>
                  <tr *ngFor="let vendor of getVendorData; let i = index">
                    <td>{{ i + 1 }}</td>
                    <td>{{ vendor?.vendorCompanyName }}</td>
                    <td>{{ vendor?.dateOfOrder | date: 'dd-MM-yyyy' }}</td>
                    <td>{{ vendor?.orderDetails }}</td>
                    <td class="text-center">
                      <button type="button" class="btn btn-default text-lime-green btn-sm"
                        (click)="openVendorModal('edit', vendor)">
                        <span class="bi bi-pencil"></span>
                      </button>
                      <button type="button" class="btn btn-default text-danger btn-sm"
                        (click)="deleteVendor(vendor?.vendorId)">
                        <span class="bi bi-trash"></span>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
           <!-- Expenditure Section for selectedBudgetHead===89 -->
        <div class="card" *ngIf="selectedBudgetHead=='77' || selectedBudgetHead=='78' || selectedBudgetHead=='79' || selectedBudgetHead=='80' || selectedBudgetHead=='81'">
            <div class="card-header bg-transparent">
                <div class="row align-items-center">
                    <div class="col-8 col-sm-8 col-md-9 col-lg-10">
                        <h6 class="fw-600 mb-2 mb-sm-3 mb-md-0">Expenditure</h6>
                    </div>
                    <div class="col-4 col-sm-4 col-md-3 col-lg-2">
                        <div class="text-end">
                            <button type="button" class="btn btn-sm btn-lime-green" (click)="openModel('add')"><span class="bi bi-plus-lg"></span> Add</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body">      
                <div class="table-scroll-container">                    
                    <table id="view-Priliminary" class="table table-bordered nowrap w-100 trainingTable">
                        <thead class="bg-lime-green text-white">
                            <tr>
                                <th>S.No</th>
                                <th>Date of hiring</th>
                                <th>Expenditure Amount</th>
                                <th>Bill No.</th>
                                <th>Bill Date</th>
                                <th>Mode Of Payment</th>
                                <th>Payee Name</th>
                                <th>Account Number</th>
                                <th>Bank Name</th>
                                <th>IFSC Code</th>
                                <th>Transaction Id</th>
                                <th>Cheque Number</th>
                                <th>Cheque Date</th>
                                <th class="text-center">Edit / Delete</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngIf="!getPreliminaryData || getPreliminaryData.length === 0">
                                <td colspan="15" class="text-center text-muted">Data Not available.</td>
                            </tr>
                            <tr *ngFor="let preliminary of getPreliminaryData; let i = index">
                                <td>{{ i + 1 }}</td>
                                <td class="noWrap">{{ preliminary?.paymentDate }}</td>
                                <td>{{ preliminary?.expenditureAmount }}</td>
                                <td>{{ preliminary?.billNo }}</td>
                                <td class="noWrap">{{ preliminary?.billDate }}</td>
                                <td>{{ preliminary?.modeOfPayment }}</td>
                                <td>{{ preliminary?.payeeName }}</td>
                                <td>{{ preliminary?.accountNumber }}</td>
                                <td>{{ preliminary?.bankName }}</td>
                                <td>{{ preliminary?.ifscCode }}</td>
                                <td>{{ preliminary?.transactionId }}</td>
                                <td>{{preliminary?.checkNo }}</td>
                                <td class="noWrap">{{preliminary?.checkDate }}</td>
                                <td class="text-center">
                                    <button type="button" class="btn btn-default text-lime-green btn-sm" (click)="openModel('edit', preliminary)">
                                        <span class="bi bi-pencil"></span>
                                    </button>
                                    <button type="button" class="btn btn-default text-danger btn-sm" (click)="deletePreliminary(preliminary?.id)">
                                        <span class="bi bi-trash"></span>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

            <div class="card" *ngIf="selectedBudgetHead=='82' || selectedBudgetHead=='84'">
                            <div class="card-header bg-transparent">
                                <div class="row align-items-center">
                                    <div class="col-8 col-sm-8 col-md-8 col-lg-8">
                                        <h6 class="fw-600 mb-2 mb-sm-3 mb-md-0">Expenditure</h6>
                                    </div>
                                    <div class="col-4 col-sm-4 col-md-4 col-lg-4">
                                        <div class="text-end">
                                             <button type="button" class="btn btn-sm btn-lime-green me-2" (click)="openModelPayment('add')">Add Payment</button>
                                            <button type="button" class="btn btn-sm btn-lime-green" (click)="openModelContingency('add')"><span class="bi bi-plus-lg"></span> Add Employee</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body mb-3">
                                <h6 class="fw-600 mb-2 mb-sm-3 mb-md-0">View Resource Details</h6>
                                  <div class="table-scroll-container">
                                <table id="view-Priliminary" class="table table-bordered nowrap w-100 trainingTable">
                                  <thead class="bg-lime-green text-white">
                                    <tr>
                                      <th>S.No</th>
                                      <th>Name of the Employee</th>
                                      <th>Designation</th>
                                      <th>Relevant Experience (Years)</th>
                                      <th>Educational Qualifications</th>
                                      <th>Date of Joining</th>
                                      <th>Remuneration (in Rs.)</th>
                                      <th>Bank Name </th>
                                      <th> IFSC Code</th>
                                      <th class="text-center">Edit / Delete</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngIf="!getContingencyData || getContingencyData.length === 0">
                                      <td colspan="9" class="text-center text-muted">Data Not available.</td>
                                    </tr>
                                    <tr *ngFor="let preliminary of getContingencyData; let i = index">
                                      <td>{{ i + 1 }}</td>
                                      <td>{{ preliminary?.name }}</td>
                                      <td>{{ preliminary?.designation }}</td>
                                      <td>{{ preliminary?.relevantExperience }}</td>
                                      <td>{{ preliminary?.educationalQualification }}</td>
                                      <td>{{ preliminary?.dateOfJoining }}</td>
                                      <td>{{ preliminary?.monthlySal }}</td>
                                      <td>
                                        {{ preliminary?.bankName }}
                                      </td>
                                      <td>
                                        {{ preliminary?.ifscCode }}
                                      </td>
                                      <td class="text-center">
                                        <button type="button" class="btn btn-default text-lime-green btn-sm" (click)="openModelContingency('edit',preliminary)">
                                          <span class="bi bi-pencil"></span>
                                        </button>
                                        <button type="button" class="btn btn-default text-danger btn-sm" (click)="deleteContingency(preliminary?.resourceId)">
                                          <span class="bi bi-trash"></span>
                                        </button>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                            </div>

                            </div>
                             <div class="card-body mb-3">
                                <h6 class="fw-600 mb-2 mb-sm-3 mb-md-0">View Payment Details</h6>
                                  <div class="table-scroll-container">
                                <table id="view-Payments" class="table table-bordered nowrap w-100 trainingTable">
                                    <thead class="bg-lime-green text-white">
                                        <tr>
                                            <th>S.No</th>
                                            <th>Amount (in Rs.)</th>
                                            <th>Payment For Month</th>
                                            <th>Date of Payment</th>
                                            <th>Employee Name</th>
                                            <th class="text-center">Edit / Delete</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                         <tr *ngIf="!getPaymentsData || getPaymentsData.length === 0">
                                        <td colspan="10" class="text-center text-muted">No Payment data available.</td>
                                    </tr>
                                        <tr *ngFor="let payment of getPaymentsData; let i = index">
                                            <td>{{ i + 1 }}</td>
                                            <td>{{ payment?.amount }}</td>
                                            <td>{{ payment?.paymentForMonth }}</td>
                                            <td>{{ payment?.dateOfPayment }}</td>
                                            <td>{{ payment?.resourceName }}</td>
                                            <td class="text-center">
                                                <button type="button" class="btn btn-default text-lime-green btn-sm" (click)="openModelPayment('edit', payment)">
                                                    <span class="bi bi-pencil"></span>
                                                </button>
                                                <button type="button" class="btn btn-default text-danger btn-sm" (click)="deletePayment(payment?.nonTrainingResourceExpenditureId)">
                                                    <span class="bi bi-trash"></span>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            </div>
                        </div>

       

        </div>
      </div>
    </div>
  </section>
</main>


<!-- Upload Modal -->
<div class="modal fade" id="addUpload" tabindex="-1" aria-labelledby="addUploadLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header py-2">
                <h6 class="modal-title text-white" id="addUploadLabel">{{isEditModeUpload ? 'Update' : 'Add'}} Media Deatils</h6>
                <button type="button" class="btn-close me-1" data-bs-dismiss="modal" aria-label="Close" (click)="resetmediaDeatilsForm()"></button>
            </div>
            <div class="modal-body">
                <form [formGroup]="mediaDeatilsForm" (ngSubmit)="onSubmitUpload()">
                    <div class="row">
                        <!-- Content Name -->
                        <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="contentName" 
                                       formControlName="contentName"
                                       [class.is-invalid]="isSubmitted && fMedia['contentName'].invalid"
                                       placeholder="Content Name">
                                <label for="contentName">{{selectedBudgetHead=='77'?'Video':'Content'}} Name</label>
                                <div *ngIf="isSubmitted && fMedia['contentName'].invalid" class="invalid-feedback">
                                    {{selectedBudgetHead=='77'?'Video':'Content'}} name is required
                                </div>
                            </div>
                        </div>

                        <!-- Content Type -->
                        <div class="col-12 col-sm-6 col-md-4 col-lg-4" hidden>
                            <div class="form-floating mb-3">
                                <select class="form-select" id="contentType" 
                                        formControlName="contentType"
                                        [class.is-invalid]="isSubmitted && fMedia['contentType'].invalid">
                                    <option value="">Select 'Content' Type</option>
                                    <option value="PDF">PDF</option>
                                    <option value="Video">Video</option>
                                    <option value="Audio">Audio</option>
                                    <option value="Document">Document</option>
                                    <option value="Image">Image</option>
                                    <option value="Presentation">Presentation</option>
                                </select>
                                <label for="contentType">Content Type</label>
                                <div *ngIf="isSubmitted && fMedia['contentType'].invalid" class="invalid-feedback">
                                    Content type is required
                                </div>
                            </div>
                        </div>

                        <!-- Topic -->
                        <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="topic" 
                                       formControlName="topic"
                                       [class.is-invalid]="isSubmitted && fMedia['topic'].invalid"
                                       placeholder="Topic">
                                <label for="topic">Topic</label>
                                <div *ngIf="isSubmitted && fMedia['topic'].invalid" class="invalid-feedback">
                                    Topic is required
                                </div>
                            </div>
                        </div>

                        <!-- Duration or Pages -->
                        <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                            <div class="form-floating mb-3">
                                <input type="number" class="form-control" id="durationOrPages" 
                                       formControlName="durationOrPages"
                                       [class.is-invalid]="isSubmitted && fMedia['durationOrPages'].invalid"
                                       min="1"
                                       placeholder="Duration (minutes) or Pages">
                                <label for="durationOrPages">Duration (minutes) or Pages</label>
                                <div *ngIf="isSubmitted && fMedia['durationOrPages'].invalid" class="invalid-feedback">
                                    <span *ngIf="fMedia['durationOrPages'].errors?.['required']">This field is required</span>
                                    <span *ngIf="fMedia['durationOrPages'].errors?.['min']">Value must be at least 1</span>
                                </div>
                            </div>
                        </div>

                        <!-- Status -->
                        <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                            <div class="form-floating mb-3">
                                <select class="form-select" id="status" 
                                        formControlName="status"
                                        [class.is-invalid]="isSubmitted && fMedia['status'].invalid">
                                    <option value="">Select Status</option>
                                    <option value="Active">Active</option>
                                    <option value="Pending">Pending</option>
                                    <option value="Inactive">Inactive</option>
                                </select>
                                <label for="status">Status</label>
                                <div *ngIf="isSubmitted && fMedia['status'].invalid" class="invalid-feedback">
                                    Status is required
                                </div>
                            </div>
                        </div>

                        <!-- Date of Upload -->
                        <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                            <div class="form-floating mb-3">
                                <input type="date" class="form-control" id="dateOfUpload" 
                                       formControlName="dateOfUpload"
                                       [class.is-invalid]="isSubmitted && fMedia['dateOfUpload'].invalid"
                                       placeholder="Date of Upload">
                                <label for="dateOfUpload">Date of Upload</label>
                                <div *ngIf="isSubmitted && fMedia['dateOfUpload'].invalid" class="invalid-feedback">
                                    Date of upload is required
                                </div>
                            </div>
                        </div>
                          <!-- Topic -->
                        <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="url" 
                                       formControlName="url"
                                       [class.is-invalid]="isSubmitted && fMedia['url'].invalid"
                                       placeholder="url">
                                <label for="url">URL</label>
                                <div *ngIf="isSubmitted && fMedia['url'].invalid" class="invalid-feedback">
                                    URL is required
                                </div>
                            </div>
                        </div>
                        <!-- File Upload -->
                        <!-- <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                            <div class="form-floating mb-3">
                                <input type="file" class="form-control" id="uploadFile" 
                                       formControlName="uploadFile" 
                                       (change)="onUploadFileSelected($event)"
                                       [class.is-invalid]="isSubmitted && fMedia['uploadFile'].invalid">
                                <label for="uploadFile">Upload File</label>
                                <div *ngIf="isSubmitted && fMedia['uploadFile'].invalid" class="invalid-feedback">
                                    File is required
                                </div>
                            </div>
                        </div> -->
                    </div>

                    <div class="text-end mt-3">
                        <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal" aria-label="Close" (click)="resetmediaDeatilsForm()">Close</button>
                        <button type="submit" class="btn btn-lime-green">{{isEditModeUpload ? 'Update' : 'Add'}}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Delete Upload Modal -->
<div class="modal fade" id="exampleModalDeleteUpload" tabindex="-1" role="dialog" aria-labelledby="exampleModalDeleteUploadLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalDeleteUploadLabel">Delete Upload</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this upload?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-lime-green" (click)="confirmDeleteUpload(deleteUploadID)">Confirm</button>
            </div>
        </div>
    </div>
</div>


     <!-- begin --Delete preliminary -->
      <div class="modal fade" id="exampleModalDelete" tabindex="-1" role="dialog" aria-labelledby="exampleModalDeleteLabel"
aria-hidden="true">
<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalDeleteLabel">Delete Session</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            Are you sure you want to delete this record?
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-lime-green" (click)="ConfirmdeleteContingency(deleteContingencyID)">Confirm</button>
        </div>
    </div>
</div>
</div>
<!-- end--Delete preliminary -->
  <!-- begin:: add Contingency fund modal -->
    <div class="modal fade" id="addContingency" tabindex="-1" aria-labelledby="addContingencyLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl">
    <div class="modal-content">
      <div class="modal-header py-2">
        <h6 class="modal-title text-white" id="addContingencyLabel">{{iseditModeContingency?'Update' :'Add'}} Resource</h6>
        <button type="button" class="btn-close me-1" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="contingencyForm" (ngSubmit)="onSubmitContingency()">
          <div class="row">
            <!-- Employee Name -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                
                <input type="text" class="form-control" id="employeeName" 
                       formControlName="name"
                       [class.is-invalid]="isSubmitted && fContingency['name'].invalid"
                       placeholder="Enter employee name">
                <label for="employeeName">Name Of The Employee</label>
                <div *ngIf="isSubmitted && fContingency['name'].invalid" class="invalid-feedback">
                  <span *ngIf="fContingency['name'].errors?.['required']">Name is required</span>
                  <span *ngIf="fContingency['name'].errors?.['minlength']">Name must be at least 2 characters</span>
                </div>
              </div>
            </div>

            <!-- Designation -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <select class="form-select" id="designation" 
                        formControlName="designation"
                        [class.is-invalid]="isSubmitted && fContingency['designation'].invalid">
                  <option value="">Select Designation</option>
                  <option *ngFor="let desig of designations" [value]="desig.value">
                    {{ desig.label }}
                  </option>
                </select>
                <label for="designation">Designation</label>
                <div *ngIf="isSubmitted && fContingency['designation'].invalid" class="invalid-feedback">
                  Designation is required
                </div>
              </div>
            </div>

            <!-- Date of Joining -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="date" class="form-control" id="dateOfJoining" 
                       formControlName="dateOfJoining"
                       [class.is-invalid]="isSubmitted && fContingency['dateOfJoining'].invalid"
                       placeholder="Date of joining">
                <label for="dateOfJoining">Date of Joining</label>
                <div *ngIf="isSubmitted && fContingency['dateOfJoining'].invalid" class="invalid-feedback">
                  Date of joining is required
                </div>
              </div>
            </div>

            <!-- Relevant Experience -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="number" class="form-control" id="relevantExperience" 
                       formControlName="relevantExperience"
                       [class.is-invalid]="isSubmitted && fContingency['relevantExperience'].invalid"
                       min="0" max="50" step="0.1"
                       placeholder="Years of experience">
                <label for="relevantExperience">Relevant Experience (years)</label>
                <div *ngIf="isSubmitted && fContingency['relevantExperience'].invalid" class="invalid-feedback">
                  <span *ngIf="fContingency['relevantExperience'].errors?.['required']">Experience is required</span>
                  <span *ngIf="fContingency['relevantExperience'].errors?.['min']">Experience cannot be negative</span>
                  <span *ngIf="fContingency['relevantExperience'].errors?.['max']">Experience cannot exceed 50 years</span>
                </div>
              </div>
            </div>

            <!-- Educational Qualification -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="educationalQualification" 
                       formControlName="educationalQualification"
                       [class.is-invalid]="isSubmitted && fContingency['educationalQualification'].invalid"
                       placeholder="Educational qualification">
                <label for="educationalQualification">Educational Qualification</label>
                <div *ngIf="isSubmitted && fContingency['educationalQualification'].invalid" class="invalid-feedback">
                  Educational qualification is required
                </div>
              </div>
            </div>

            <!-- Monthly Salary -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="number" class="form-control" id="monthlySal" 
                       formControlName="monthlySal"
                       [class.is-invalid]="isSubmitted && fContingency['monthlySal'].invalid"
                       min="0" step="0.01"
                       placeholder="Monthly salary">
                <label for="monthlySal">Monthly Salary (₹)</label>
                <div *ngIf="isSubmitted && fContingency['monthlySal'].invalid" class="invalid-feedback">
                  <span *ngIf="fContingency['monthlySal'].errors?.['required']">Salary is required</span>
                  <span *ngIf="fContingency['monthlySal'].errors?.['min']">Salary cannot be negative</span>
                </div>
              </div>
            </div>

            <!-- Bank Name -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="bankName" 
                       formControlName="bankName"
                       [class.is-invalid]="isSubmitted && fContingency['bankName'].invalid"
                       placeholder="Bank name">
                <label for="bankName">Bank Name</label>
                <div *ngIf="isSubmitted && fContingency['bankName'].invalid" class="invalid-feedback">
                  Bank name is required
                </div>
              </div>
            </div>

            <!-- IFSC Code -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="ifscCode" 
                       formControlName="ifscCode"
                       [class.is-invalid]="isSubmitted && fContingency['ifscCode'].invalid"
                       placeholder="IFSC code" 
                       pattern="^[A-Z]{4}0[A-Z0-9]{6}$"
                       maxlength="11"
                       (input)="fContingency['ifscCode'].setValue($any($event.target).value.toUpperCase())">
                <label for="ifscCode">IFSC Code</label>
                <div *ngIf="isSubmitted && fContingency['ifscCode'].invalid" class="invalid-feedback">
                  <span *ngIf="fContingency['ifscCode'].errors?.['required']">IFSC code is required</span>
                  <span *ngIf="fContingency['ifscCode'].errors?.['pattern']">Invalid IFSC format. Correct format: AAAA0BBBBBB (4 Captial letters, then 0, then 6 letters/numbers)</span>
                </div>
              </div>
            </div>

            <!-- Account Number -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="accountNo" 
                       formControlName="accountNo"
                       [class.is-invalid]="isSubmitted && fContingency['accountNo'].invalid"
                       placeholder="Account number"
                       pattern="[0-9]*"
                       minlength="9" maxlength="18">
                <label for="accountNo">Account Number</label>
                <div *ngIf="isSubmitted && fContingency['accountNo'].invalid" class="invalid-feedback">
                  <span *ngIf="fContingency['accountNo'].errors?.['required']">Account number is required</span>
                  <span *ngIf="fContingency['accountNo'].errors?.['pattern']">Only numbers are allowed</span>
                  <span *ngIf="fContingency['accountNo'].errors?.['minlength']">Account number must be at least 9 digits</span>
                  <span *ngIf="fContingency['accountNo'].errors?.['maxlength']">Account number cannot exceed 18 digits</span>
                </div>
              </div>
            </div>
          </div>

          <div class="text-end mt-3">
            <button type="button" class="btn btn-secondary me-2"  data-bs-dismiss="modal" aria-label="Close" (click)="resetFormContingency()">Close</button>
            <button type="submit" class="btn btn-lime-green">{{iseditModeContingency?'Update' :'Add'}}</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
    <!-- end:: add Contingency fund modal -->

    <!-- <div class="modal fade" id="addPayment" tabindex="-1" aria-labelledby="addPaymentLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl">
            <div class="modal-content">
                <div class="modal-header py-2">
                    <h6 class="modal-title text-white" id="addPaymentLabel">Add Payment</h6>
                    <button type="button" class="btn-close me-1" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="row">
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="itamount2" placeholder="">
                                    <label for="itamount2">Amount</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="itbillno2" placeholder="">
                                    <label for="itbillno2">Bill No.</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="date" class="form-control" id="billDate2" placeholder="">
                                    <label for="billDate2">Bill Date</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <select class="form-select" id="modePayment2">
                                        <option value="#">Select Payment Mode</option>
                                        <option value="1">Netbanking</option>
                                        <option value="2">Cash</option>
                                    </select>
                                    <label for="modePayment2">Mode Of Payment</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="payeeName2" placeholder="">
                                    <label for="payeeName2">Payee Name</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="transcationId2" placeholder="">
                                    <label for="transcationId2">Transcation Id</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="Bank2" placeholder="">
                                    <label for="Bank2">Bank</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="ifscCode2" placeholder="">
                                    <label for="ifscCode2">IFSC Code</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="purpose2" placeholder="">
                                    <label for="purpose2">Purpose</label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                                <div class="form-floating mb-3">
                                    <input type="file" class="form-control" id="uploadfile2">
                                    <label for="uploadfile2">Upload Bill Invoice</label>
                                </div>
                            </div>
                        </div>
                    </form>

                    <div class="text-end mt-3">
                        <button type="button" class="btn btn-lime-green">Add</button>
                    </div>
                </div>
            </div>
        </div>
    </div> -->

    <div class="modal fade" id="viewPayment" tabindex="-1" aria-labelledby="viewpaymentLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl">
            <div class="modal-content">
                <div class="modal-header py-2">
                    <h6 class="modal-title text-white" id="viewpaymentLabel">View Payment Details</h6>
                    <button type="button" class="btn-close me-1" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="table-scroll-container">                    
                     <table class="table table-bordered nowrap w-100 trainingTable">
                                    <thead class="bg-lime-green text-white">
                                        <tr>
                                            <th>S.No</th>
                                            <th>Amount (in Rs.)</th>
                                            <th>Payment For Month</th>
                                            <th>Date of Payment</th>
                                            <th>Resource Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                         <tr *ngIf="!viewPaymentData || viewPaymentData.length === 0">
                                        <td colspan="10" class="text-center text-muted">No Payment data available.</td>
                                    </tr>
                                        <tr *ngFor="let payment of viewPaymentData; let i = index">
                                            <td>{{ i + 1 }}</td>
                                            <td>{{ payment?.amount }}</td>
                                            <td>{{ payment?.paymentForMonth }}</td>
                                            <td>{{ payment?.dateOfPayment }}</td>
                                            <td>{{ payment?.resourceName }}</td>
                                          
                                        </tr>
                                    </tbody>
                                </table>
                  </div>

                    <div class="text-end mt-3">
                        <button type="button" class="btn btn-lime-green" data-bs-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addPayment" tabindex="-1" aria-labelledby="addPaymentLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl">
    <div class="modal-content">
      <div class="modal-header py-2">
        <h6 class="modal-title text-white" id="addPaymentLabel">{{iseditModePayment?'Update' :'Add'}} Payment</h6>
        <button type="button" class="btn-close me-1" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="paymentForm" (ngSubmit)="onSubmitPayment()">
          <div class="row">
             <!-- Resource ID -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                 <select class="form-select events-expenditure" id="resourceId" formControlName="resourceId" (change)="onResourceChange($any($event.target).value,resourceList)">
                        <option value="">Select Employee</option>
                    <option *ngFor="let item of resourceList" value="{{item?.resourceId}}">{{item?.name}}</option>
                        <!-- <option value="#">Select Budget Head</option>
                        <option value="1">Preliminary survey for selection of potential SHGs</option>
                        <option value="2">Dashboard / Central Management System</option>
                        <option value="5">Contingency fund</option> -->
                </select>
                <label for="resourceId">Employee Name</label>
                <div *ngIf="isSubmitted && fPayment['resourceId'].invalid" class="invalid-feedback" id="resourceError">
                  <span *ngIf="fPayment['resourceId'].errors?.['required']">Resource ID is required</span>
                  
                </div>
              </div>
            </div>
             <!-- Bank Name -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="bankName"  readonly
                       formControlName="bankName"
                       placeholder="Bank name">
                <label for="bankName">Bank Name</label>
              
              </div>
            </div>
            <!-- IFSC Code -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="ifscCode"  formControlName="ifscCode" placeholder="IFSC code" readonly >
                <label for="ifscCode">IFSC Code</label>
              </div>
            </div>

            <!-- Account Number -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="accountNo" 
                       formControlName="accountNo" readonly>
                <label for="accountNo">Account Number</label>
              </div>
            </div>

            <!-- Amount -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="number" class="form-control" id="amount" 
                       formControlName="amount"
                       [class.is-invalid]="isSubmitted && fPayment['amount'].invalid"
                       placeholder="Amount" 
                       min="0" 
                       step="0.01"
                       [attr.aria-describedby]="isSubmitted && fPayment['amount'].invalid ? 'amountError' : null">
                <label for="amount">Amount (₹)</label>
                <div *ngIf="isSubmitted && fPayment['amount'].invalid" class="invalid-feedback" id="amountError">
                  <span *ngIf="fPayment['amount'].errors?.['required']">Amount is required</span>
                  <span *ngIf="fPayment['amount'].errors?.['min']">Amount must be positive</span>
                  <span *ngIf="fPayment['amount'].errors?.['max']">Amount is too large</span>
                </div>
              </div>
            </div>
            <!-- Payment For Month -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <!-- <app-monthly-range (monthChangeValue)="onChangeDate($event)" [paymentForMonth]="paymentForMonth" ></app-monthly-range> -->
                <app-monthly-range [paymentForMonth]="paymentForMonth" [disableFuture]="true" (monthChangeValue)="onChangeDate($event)"></app-monthly-range>
                                <!-- <mat-form-field appearance="outline">
                    <mat-label>Payment For Month</mat-label>
                    <input matInput [matDatepicker]="dp1" [formControl]="date1"
                    (click)="dp1.open()" (keydown)="false">    
                    <mat-datepicker-toggle matSuffix [for]="dp1"></mat-datepicker-toggle>
                    <mat-datepicker #dp1 startView="multi-year" (monthSelected)="setMonthAndYear($event, dp1)"
                        panelClass="example-month-picker">
                    </mat-datepicker>
                </mat-form-field> -->
              </div>
            </div>
            <!-- Date of Payment -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="date" class="form-control" id="dateOfPayment" appDisableFutureDates
                       formControlName="dateOfPayment"
                       [class.is-invalid]="isSubmitted && fPayment['dateOfPayment'].invalid"
                       placeholder="Date of payment"
                       [attr.aria-describedby]="isSubmitted && fPayment['dateOfPayment'].invalid ? 'dateError' : null">
                <label for="dateOfPayment">Date of Payment</label>
                <div *ngIf="isSubmitted && fPayment['dateOfPayment'].invalid" class="invalid-feedback" id="dateError">
                  Date of payment is required
                </div>
              </div>
            </div>
             <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="file" class="form-control" formControlName="uploadBillUrl" (change)="onFileSelectedPayment($event)">
                <label for="uploadBill">Upload Bill Invoice</label>
              </div>
            </div>
          
           
          </div>

          <div class="text-end mt-3">
            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal" aria-label="Close" (click)="resetForm()">Close</button>
            <button type="submit" class="btn btn-lime-green">{{iseditModePayment?'Update' :'Add'}}  Payment</button>
          </div>
        </form>
      </div>
    </div>
  </div>
<!-- delete continuity -->

   <!-- begin --Delete preliminary -->
   
<!-- end--Delete preliminary -->
</div>
   <div class="modal fade" id="exampleModalDeleteContinuty" tabindex="-1" role="dialog" aria-labelledby="exampleModalDeleteContinutyLabel"
aria-hidden="true">
<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalDeleteContinutyLabel">Delete Record</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            Are you sure you want to delete this record?
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-lime-green" (click)="ConfirmdeleteContingency(deleteContingencyID)">Confirm</button>
        </div>
    </div>
</div>
</div>
   <div class="modal fade" id="exampleModalDeletePayment" tabindex="-1" role="dialog" aria-labelledby="exampleModalDeletePaymentLabel"
aria-hidden="true">
<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalDeletePaymentLabel">Delete Session</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            Are you sure you want to delete this record?
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-lime-green" (click)="ConfirmdeletePayment(deleteContingencyID)">Confirm</button>
        </div>
    </div>
</div>
</div>

<!-- Vendor Add/Edit Modal -->
<div class="modal fade" id="addVendor" tabindex="-1" aria-labelledby="addVendorLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addVendorLabel">
          {{ isEditModeVendor ? 'Edit Vendor Details' : 'Add Vendor Details' }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form [formGroup]="vendorForm" (ngSubmit)="onSubmitVendor()">
        <div class="modal-body">
          <div class="row">
            <!-- Vendor Company Name -->
            <div class="col-12 col-sm-6 col-md-6 col-lg-6">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="vendorCompanyName" 
                       formControlName="vendorCompanyName"
                       [class.is-invalid]="isSubmitted && fVendor['vendorCompanyName'].invalid"
                       placeholder="Vendor Company Name"
                       [attr.aria-describedby]="isSubmitted && fVendor['vendorCompanyName'].invalid ? 'vendorCompanyNameError' : null">
                <label for="vendorCompanyName">Vendor Company Name</label>
                <div *ngIf="isSubmitted && fVendor['vendorCompanyName'].invalid" class="invalid-feedback" id="vendorCompanyNameError">
                  <span *ngIf="fVendor['vendorCompanyName'].errors?.['required']">
                    Vendor company name is required
                  </span>
                  <span *ngIf="fVendor['vendorCompanyName'].errors?.['minlength']">
                    Vendor company name must be at least 2 characters long
                  </span>
                </div>
              </div>
            </div>

            <!-- Date of Order -->
            <div class="col-12 col-sm-6 col-md-6 col-lg-6">
              <div class="form-floating mb-3">
                <input type="date" class="form-control" id="dateOfOrder" 
                       formControlName="dateOfOrder"
                       [class.is-invalid]="isSubmitted && fVendor['dateOfOrder'].invalid"
                       placeholder="Date of Order"
                       [attr.aria-describedby]="isSubmitted && fVendor['dateOfOrder'].invalid ? 'dateOfOrderError' : null">
                <label for="dateOfOrder">Date of Order</label>
                <div *ngIf="isSubmitted && fVendor['dateOfOrder'].invalid" class="invalid-feedback" id="dateOfOrderError">
                  Date of order is required
                </div>
              </div>
            </div>

            <!-- Order Details -->
            <div class="col-12">
              <div class="form-floating mb-3">
                <textarea class="form-control" id="orderDetails" 
                          formControlName="orderDetails"
                          [class.is-invalid]="isSubmitted && fVendor['orderDetails'].invalid"
                          placeholder="Order Details"
                          style="height: 120px;"
                          [attr.aria-describedby]="isSubmitted && fVendor['orderDetails'].invalid ? 'orderDetailsError' : null"></textarea>
                <label for="orderDetails">Order Details</label>
                <div *ngIf="isSubmitted && fVendor['orderDetails'].invalid" class="invalid-feedback" id="orderDetailsError">
                  <span *ngIf="fVendor['orderDetails'].errors?.['required']">
                    Order details are required
                  </span>
                  <span *ngIf="fVendor['orderDetails'].errors?.['minlength']">
                    Order details must be at least 10 characters long
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-lime-green">
            {{ isEditModeVendor ? 'Update Vendor' : 'Save Vendor' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Vendor Delete Confirmation Modal -->
<div class="modal fade" id="exampleModalDeleteVendor" tabindex="-1" aria-labelledby="exampleModalDeleteVendorLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalDeleteVendorLabel">Confirm Delete</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete this vendor record?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-lime-green" (click)="confirmDeleteVendor(deleteVendorID)">Confirm</button>
      </div>
    </div>
  </div>
</div>

<!-- Expenditure Modal -->
<div class="modal fade" id="addSurvey" tabindex="-1" aria-labelledby="addSurveyLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl">
    <div class="modal-content">
      <div class="modal-header py-2">
        <h6 class="modal-title text-white" id="addSurveyLabel">{{iseditMode?'Update' :'Add'}} Expenditure</h6>
        <button type="button" class="btn-close me-1" data-bs-dismiss="modal" aria-label="Close" (click)="resetForm()" ></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="financialForm" (ngSubmit)="onSubmit()">
          <div class="row">
            <!-- Agency ID (hidden or visible depending on requirements) -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4" *ngIf="false">
              <div class="form-floating mb-3">
                <input type="number" class="form-control" formControlName="agencyId" 
                       [class.is-invalid]="isSubmitted && f['agencyId'].invalid">
                <label for="agencyId">Agency ID</label>
              </div>
            </div>

            <!-- Payment Date -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="date" class="form-control" formControlName="paymentDate" appDisableFutureDates
                       [class.is-invalid]="isSubmitted && f['paymentDate'].invalid">
                <label for="paymentDate">Date of hiring</label>
                <div *ngIf="isSubmitted && f['paymentDate'].invalid" class="invalid-feedback">
                  <span *ngIf="f['paymentDate'].errors?.['required']">Payment date is required</span>
                </div>
              </div>
            </div>

            <!-- Expenditure Amount -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="number" class="form-control" formControlName="expenditureAmount" 
                       [class.is-invalid]="isSubmitted && f['expenditureAmount'].invalid">
                <label for="expenditureAmount">Expenditure Amount</label>
                <div *ngIf="isSubmitted && f['expenditureAmount'].invalid" class="invalid-feedback">
                  <span *ngIf="f['expenditureAmount'].errors?.['required']">Expenditure amount is required</span>
                  <span *ngIf="f['expenditureAmount'].errors?.['min']">Amount must be greater than 0</span>
                </div>
              </div>
            </div>

            <!-- Bill No -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" formControlName="billNo" 
                       [class.is-invalid]="isSubmitted && f['billNo'].invalid">
                <label for="billNo">Bill No</label>
                <div *ngIf="isSubmitted && f['billNo'].invalid" class="invalid-feedback">
                  <span *ngIf="f['billNo'].errors?.['required']">Bill number is required</span>
                </div>
              </div>
            </div>

            <!-- Bill Date -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="date" class="form-control" formControlName="billDate" appDisableFutureDates
                       [class.is-invalid]="isSubmitted && f['billDate'].invalid">
                <label for="billDate">Bill Date</label>
                <div *ngIf="isSubmitted && f['billDate'].invalid" class="invalid-feedback">
                  <span *ngIf="f['billDate'].errors?.['required']">Bill date is required</span>
                </div>
              </div>
            </div>

            <!-- Payee Name -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" formControlName="payeeName" 
                       [class.is-invalid]="isSubmitted && f['payeeName'].invalid">
                <label for="payeeName">Payee Name</label>
                <div *ngIf="isSubmitted && f['payeeName'].invalid" class="invalid-feedback">
                  <span *ngIf="f['payeeName'].errors?.['required']">Payee name is required</span>
                </div>
              </div>
            </div>

            <!-- Account Number -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" formControlName="accountNumber" 
                       [class.is-invalid]="isSubmitted && f['accountNumber'].invalid">
                <label for="accountNumber">Account Number</label>
                <div *ngIf="isSubmitted && f['accountNumber'].invalid" class="invalid-feedback">
                  <span *ngIf="f['accountNumber'].errors?.['required']">Account number is required</span>
                </div>
              </div>
            </div>

            <!-- Bank Name -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" formControlName="bankName" 
                       [class.is-invalid]="isSubmitted && f['bankName'].invalid">
                <label for="bankName">Bank Name</label>
                <div *ngIf="isSubmitted && f['bankName'].invalid" class="invalid-feedback">
                  <span *ngIf="f['bankName'].errors?.['required']">Bank name is required</span>
                </div>
              </div>
            </div>

            <!-- Mode of Payment -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <select class="form-select" formControlName="modeOfPayment" 
                        (change)="modeOfPaymentIt($any($event.target).value)"
                        [class.is-invalid]="isSubmitted && f['modeOfPayment'].invalid">
                  <option value="">Select Mode of Payment</option>
                  <option value="CASH">Cash</option>
                  <option value="BANK_TRANSFER">Bank Transfer</option>
                  <option value="UPI">UPI</option>
                  <option value="CHEQUE">Cheque</option>
                </select>
                <label for="modeOfPayment">Mode of Payment</label>
                <div *ngIf="isSubmitted && f['modeOfPayment'].invalid" class="invalid-feedback">
                  <span *ngIf="f['modeOfPayment'].errors?.['required']">Mode of payment is required</span>
                </div>
              </div>
            </div>

            <!-- UPI Transaction ID -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4" *ngIf="f['modeOfPayment']?.value === 'UPI' || f['modeOfPayment']?.value === 'BANK_TRANSFER'">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" formControlName="transactionId" 
                       [class.is-invalid]="isSubmitted && f['transactionId'].invalid">
                <label for="transactionId">Transaction ID</label>
                <div *ngIf="isSubmitted && f['transactionId'].invalid" class="invalid-feedback">
                  <span *ngIf="f['transactionId'].errors?.['required']">Transaction ID is required</span>
                </div>
              </div>
            </div>

            <!-- Cheque No -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4" *ngIf="f['modeOfPayment']?.value === 'CHEQUE'">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" formControlName="checkNo" 
                       [class.is-invalid]="isSubmitted && f['checkNo'].invalid">
                <label for="checkNo">Cheque No</label>
                <div *ngIf="isSubmitted && f['checkNo'].invalid" class="invalid-feedback">
                  <span *ngIf="f['checkNo'].errors?.['required']">Cheque number is required</span>
                </div>
              </div>
            </div>

            <!-- Cheque Date -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4" *ngIf="f['modeOfPayment']?.value === 'CHEQUE'">
              <div class="form-floating mb-3">
                <input type="date" class="form-control" formControlName="checkDate" appDisableFutureDates
                       [class.is-invalid]="isSubmitted && f['checkDate'].invalid">
                <label for="checkDate">Cheque Date</label>
                <div *ngIf="isSubmitted && f['checkDate'].invalid" class="invalid-feedback">
                  <span *ngIf="f['checkDate'].errors?.['required']">Cheque date is required</span>
                </div>
              </div>
            </div>

            <!-- IFSC Code -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4" *ngIf="f['modeOfPayment']?.value === 'BANK_TRANSFER'">
              <div class="form-floating mb-3">
                <input type="text" class="form-control" formControlName="ifscCode" 
                       [class.is-invalid]="isSubmitted && f['ifscCode'].invalid">
                <label for="ifscCode">IFSC Code</label>
                <div *ngIf="isSubmitted && f['ifscCode'].invalid" class="invalid-feedback">
                  <span *ngIf="f['ifscCode'].errors?.['required']">IFSC code is required</span>
                    <span *ngIf="f['ifscCode'].errors?.['pattern']">Invalid IFSC format. Correct format: AAAA0BBBBBB (4 Captial letters, then 0, then 6 letters/numbers)</span>
                </div>
              </div>
            </div>

            <!-- Upload Bill -->
            <div class="col-12 col-sm-6 col-md-4 col-lg-4">
              <div class="form-floating mb-3">
                <input type="file" class="form-control" formControlName="uploadBillUrl" (change)="onFileSelected($event)">
                <label for="uploadBill">Upload Bill Invoice</label>
              </div>
            </div>
          </div>

          <div class="text-end mt-3">
            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal" aria-label="Close" (click)="resetForm()">Close</button>
            <button type="submit" class="btn btn-lime-green">{{iseditMode?'Update' :'Add'}}</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Delete Expenditure Modal -->
<div class="modal fade" id="exampleModalDelete" tabindex="-1" role="dialog" aria-labelledby="exampleModalDeleteLabel"
aria-hidden="true">
<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalDeleteLabel">Delete Session</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            Are you sure you want to delete this record?
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-lime-green" (click)="ConfirmdeleteExpenditure(deletePreliminaryID)">Confirm</button>
        </div>
    </div>
</div>
</div>