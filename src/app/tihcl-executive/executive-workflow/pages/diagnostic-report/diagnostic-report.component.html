 <fieldset>
   <div class="card border rounded-2 shadow-none mb-3">
     <div class="card-header bg-theme text-white">
       <h6 class="mb-0">Diagnostic Report</h6>
     </div>
     <div class="card-body">
       <div class="row">
         <div class="col-12">
           <ul class="nav nav-tabs" role="tablist">
             <li class="nav-item" role="presentation">
               <button class="nav-link rounded-0 py-1 fs-md" [class.active]="currentTab === 'BASIC_DETAILS'"
                 (click)="switchTab('BASIC_DETAILS')">Basic Details</button>
             </li>
             <li class="nav-item" role="presentation">
               <button class="nav-link rounded- py-1 fs-md" [class.active]="currentTab === 'TOP_5_BUYERS'"
                 (click)="switchTab('TOP_5_BUYERS')">Top Buyers/Suppliers</button>
             </li>
             <li class="nav-item" role="presentation">
               <button class="nav-link rounded- py-1 fs-md" [class.active]="currentTab === 'RECEIVABLES_PAYABLES'"
                 (click)="switchTab('RECEIVABLES_PAYABLES')">Receivables / Payables</button>
             </li>
             <li class="nav-item" role="presentation">
               <button class="nav-link rounded-0 py-1 fs-md" [class.active]="currentTab === 'OPERATIONAL_STATUS'"
                 (click)="switchTab('OPERATIONAL_STATUS')">Operational Status</button>
             </li>
             <li class="nav-item" role="presentation">
               <button class="nav-link rounded-0 py-1 fs-md" [class.active]="currentTab === 'REASONS_FOR_STRESS'"
                 (click)="switchTab('REASONS_FOR_STRESS')">Reasons for Stress</button>
             </li>
             <li class="nav-item" role="presentation">
               <button class="nav-link rounded-0 py-1 fs-md" [class.active]="currentTab === 'BALANCE_SHEET'"
                 (click)="switchTab('BALANCE_SHEET')">Balance Sheet</button>
             </li>
             <li class="nav-item" role="presentation">
               <button class="nav-link rounded-0 py-1 fs-md" [class.active]="currentTab === 'STATUS_UPDATE'"
                 (click)="switchTab('STATUS_UPDATE')">Observations</button>
             </li>
           </ul>
           <form [formGroup]="diagnosticForm">
             <div class="tab-content mt-2">
               <!-- begin:: basic details -->
               <div class="tab-pane fade show active" role="tabpanel" aria-labelledby="basic-tab"
                 [ngClass]="{ 'active':currentTab === 'BASIC_DETAILS'}"
                 [class.show.active]="currentTab === 'BASIC_DETAILS'">

                 <div class="p-2">
                   <form [formGroup]="basicDetails">
                     <div class="row">
                       <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="text" class="form-control" id="nameInput" placeholder="" formControlName="nameOfUnit">
                           <label for="nameInput">Name of the Unit <span class="text-danger">*</span></label>
                           <div
                             *ngIf="basicDetails.get('nameOfUnit')?.invalid && (basicDetails.get('nameOfUnit')?.dirty || basicDetails.get('nameOfUnit')?.touched)"
                             class="text-danger small">
                             Name of the Unit is required
                           </div>
                         </div>
                       </div>
                       <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="text" class="form-control" id="contactInput" placeholder=""
                             formControlName="contactNo">
                           <label for="contactInput">Contact No. <span class="text-danger">*</span></label>
                           <div
                             *ngIf="basicDetails.get('contactNo')?.invalid && (basicDetails.get('contactNo')?.dirty || basicDetails.get('contactNo')?.touched)"
                             class="text-danger small">
                             Contact No Starts with 6,7,8,9 and should be 10 digits
                           </div>
                         </div>
                       </div>
                       <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="text" class="form-control" id="gstInput" placeholder=""
                             formControlName="gstNumber">
                           <label for="gstInput">GST Number</label>
                           <div *ngIf="basicDetails.get('gstNumber')?.errors?.invalidFormat" class="text-danger small">
                             Invalid format. Example: 22AAAAA0000A1Z5
                           </div>
                           <div
                             *ngIf="!basicDetails.get('gstNumber')?.errors?.invalidFormat && basicDetails.get('gstNumber')?.invalid && (basicDetails.get('gstNumber')?.dirty || basicDetails.get('gstNumber')?.touched)"
                             class="text-danger small">
                             GST Number is required
                           </div>
                         </div>
                       </div>
                       <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="text" class="form-control" id="productInput" placeholder=""
                             formControlName="productManufactured">
                           <label for="productInput">Product Manufactured <span class="text-danger">*</span></label>
                           <div
                             *ngIf="basicDetails.get('productManufactured')?.invalid && (basicDetails.get('productManufactured')?.dirty || basicDetails.get('productManufactured')?.touched)"
                             class="text-danger small">
                             Product is required
                           </div>
                         </div>
                       </div>
                       <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="text" class="form-control" id="demandInput" placeholder=""
                             formControlName="demandForTheProduct">
                           <label for="demandInput">Demand For The Product <span class="text-danger">*</span></label>
                           <div
                             *ngIf="basicDetails.get('demandForTheProduct')?.invalid && (basicDetails.get('demandForTheProduct')?.dirty || basicDetails.get('demandForTheProduct')?.touched)"
                             class="text-danger small">
                             Demand information is required
                           </div>
                         </div>
                       </div>
                       <div class="col-12 col-sm-12 col-md-6 col-lg-4">
                         <div class="mb-3">
                           <div class="form-floating mb-3">
                             <select class="form-select" id="landDetails" formControlName="constitution" (change)="onConstitutionChange($any($event.target).value)"
                               [ngClass]="{'isDisabled':freeze>4}">
                               <option value="" disabled selected>Select Constitution</option>
                               <option value="Sole proprietorship">Sole proprietorship</option>
                               <option value="Partnership">Partnership</option>
                               <option value="LLP">LLP</option>
                               <option value="Limited company">Limited company</option>
                             </select>
                             <label for="product">Constitution<span class="text-danger">*</span></label>
                             <div
                               *ngIf="basicDetails.get('constitution')?.invalid && basicDetails.get('constitution')?.touched && !basicDetails.get('constitution')?.hasError('pattern')"
                               class="text-danger small">
                               Constitution is required
                             </div>
                           </div>
                         </div>
                       </div>
                     </div>

                     <div class="border p-2 rounded-3 mb-3" *ngIf="basicDetails.get('constitution')?.value === 'Limited company'">
                       <div class="row align-items-center">
                         <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
                           <label class="fs-md fw-bold mb-1">Shareholding Pattern</label>
                         </div>
                         <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
                           <div class="text-start text-sm-end text-xl-end">
                             <button type="button" (click)="openShareholderModal()" *ngIf="freeze<=4"
                               class="btn btn-outline-primary btn-sm border-0 ms-3">
                               <span class="bi bi-plus-lg"></span> Add
                             </button>
                           </div>
                         </div>
                       </div>

                       <div class="table-responsive mt-3" *ngIf="shareholdersNewDto.controls.length > 0">
                         <table class="table table-striped table-borderless fs-md">
                           <thead class="bg-theme text-white">
                             <tr>
                               <th>S.No</th>
                               <th>Share Holder Name</th>
                               <th>Position</th>
                               <th>% of Shares</th>
                               <th class="text-center">Edit / Delete</th>
                             </tr>
                           </thead>
                           <tbody formArrayName="shareholdersNewDto">
                             <tr *ngFor="let shareholder of shareholdersNewDto.controls; let i = index" [formGroupName]="i">
                               <td>{{i + 1}}</td>
                               <td>{{ shareholder.get('nameOfTheShareholder')?.value }}</td>
                               <td>{{ shareholder.get('position')?.value }}</td>
                               <td>{{ shareholder.get('shareholdingPercentage')?.value }}</td>
                               <td class="text-center">
                                 <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="openShareholderModal(i)"
                                   class="btn btn-default text-primary btn-sm">
                                   <span class="bi bi-pencil"></span>
                                 </button>
                                 <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="removeShareholder(i,shareholder.get('id')?.value)"
                                   class="btn btn-default text-danger btn-sm">
                                   <span class="bi bi-trash"></span>
                                 </button>
                               </td>
                             </tr>
                           </tbody>
                           <!-- <tfoot>
                             <tr>
                               <td></td>
                               <td></td>
                               <td>Total</td>
                               <td>{{getTotalShares()}}</td>
                               <td></td>
                             </tr>
                           </tfoot> -->
                         </table>
                       </div>

                       <div *ngIf="shareholdersNewDto.controls.length === 0" class="text-center py-3 text-muted">
                         No Shareholders added yet
                       </div>
                     </div>
                      <div class="border p-2 rounded-3 mb-3" *ngIf="basicDetails.get('constitution')?.value === 'Partnership'">
                       <div class="row align-items-center">
                         <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
                           <label class="fs-md fw-bold mb-1">Partnership Details</label>
                         </div>
                         <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
                           <div class="text-start text-sm-end text-xl-end">
                             <button type="button" (click)="openPartnershipModal()" *ngIf="freeze<=4"
                               class="btn btn-outline-primary btn-sm border-0 ms-3">
                               <span class="bi bi-plus-lg"></span> Add
                             </button>
                           </div>
                         </div>
                       </div>

                       <div class="table-responsive mt-3" *ngIf="partnershipDto.controls.length > 0">
                         <table class="table table-striped table-borderless fs-md">
                           <thead class="bg-theme text-white">
                             <tr>
                               <th>S.No</th>
                               <th>Name of The Partner</th>
                               <th>Position</th>
                               <th>Profit Sharing Percentage</th>
                               <th class="text-center">Edit / Delete</th>
                             </tr>
                           </thead>
                           <tbody formArrayName="partnershipDto">
                             <tr *ngFor="let shareholder of partnershipDto.controls; let i = index" [formGroupName]="i">
                               <td>{{i + 1}}</td>
                               <td>{{ shareholder.get('nameOfThePartner')?.value }}</td>
                               <td>{{ shareholder.get('position')?.value }}</td>
                               <td>{{ shareholder.get('profitSharingPercentage')?.value }}</td>
                               <td class="text-center">
                                 <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="openPartnershipModal(i)"
                                   class="btn btn-default text-primary btn-sm">
                                   <span class="bi bi-pencil"></span>
                                 </button>
                                 <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="removePartnerShip(i,shareholder.get('id')?.value)"
                                   class="btn btn-default text-danger btn-sm">
                                   <span class="bi bi-trash"></span>
                                 </button>
                               </td>
                             </tr>
                           </tbody>
                          
                         </table>
                       </div>

                       <div *ngIf="partnershipDto.controls.length === 0" class="text-center py-3 text-muted">
                         No Partnership added yet
                       </div>
                     </div>

                     <div class="text-end">
                       <button type="button" (click)="saveBasicDetails()" class="btn btn-primary" *ngIf="freeze<=4">
                         Save Basic Details
                       </button>
                       <div *ngIf="saveSuccess.basic" class="text-success small mt-2">
                         Basic details saved successfully!
                       </div>
                     </div>
                   </form>
                 </div>
               </div>
               <!-- end:: basic details -->

               <!-- begin:: Top Buyers/Suppliers details -->
               <div class="tab-pane fade p-2" role="tabpanel" aria-labelledby="buyer-tab"
                 [class.show.active]="currentTab === 'TOP_5_BUYERS'"
                 [ngClass]="{ 'active': currentTab === 'TOP_5_BUYERS' }">

                 <!-- Buyers Card -->
                 <div class="card border rounded-3 mb-3">
                   <div class="card-header bg-transparent">
                     <div class="row align-items-center">
                       <div class="col-12 col-sm-8 col-md-8 col-lg-9 col-xl-9">
                         <label class="fs-md fw-600 mb-0">Who are the top buyers?</label>
                       </div>

                       <div class="col-12 col-sm-4 col-md-4 col-lg-3 col-xl-3">
                         <div class="text-end">
                           <button type="button" (click)="openBuyerModal()" *ngIf="freeze<=4"
                             class="btn btn-outline-primary btn-sm border-0 ms-3">Add Buyer</button>

                         </div>
                       </div>
                     </div>
                   </div>
                   <div class="card-body">
                     <div class="row">
                       <div class="col-12">
                         <table class="table table-striped table-borderless fs-md">
                           <thead class="bg-theme text-white">
                             <tr>
                               <th class="text-start">S.No</th>
                               <th>Buyer Name</th>
                               <!-- <th class="text-start">Purchased Qty</th> -->
                               <th class="text-start">Amount</th>
                               <th>Remarks</th>
                               <th class="text-center">Edit / Delete</th>
                             </tr>
                           </thead>
                           <tbody formArrayName="topBuyers">
                             <tr *ngFor="let buyer of buyers.controls; let i = index" [formGroupName]="i">
                               <td class="text-start">{{i + 1}}</td>
                               <td>{{ buyer.get('buyerName')?.value }}</td>
                               <!-- <td class="text-start">{{ buyer.get('purchasedQty')?.value }}</td> -->
                               <td class="text-start">{{ buyer.get('amount')?.value }}</td>
                               <td>{{ buyer.get('remarks')?.value || '-' }}</td>
                               <td class="text-center">
                                 <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="openBuyerModal(i)"
                                   class="btn btn-default text-primary btn-sm">
                                   <span class="bi bi-pencil"></span>
                                 </button>
                                 <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="removeBuyer(i,buyer.get('id')?.value)"
                                   class="btn btn-default text-danger btn-sm">
                                   <span class="bi bi-trash"></span>
                                 </button>
                               </td>
                             </tr>
                             <tr *ngIf="buyers.controls.length === 0">
                               <td colspan="6" class="text-center py-3 text-muted">No buyers added yet</td>
                             </tr>
                           </tbody>
                         </table>
                       </div>
                     </div>
                   </div>
                 </div>

                 <!-- Suppliers Card -->
                 <div class="card border rounded-3 mb-3">
                   <div class="card-header bg-transparent">
                     <div class="row align-items-center">
                       <div class="col-12 col-sm-8 col-md-8 col-lg-9 col-xl-9">
                         <label class="fs-md fw-600 mb-0">Who are the top suppliers?</label>
                       </div>
                       <div class="col-12 col-sm-4 col-md-4 col-lg-3 col-xl-3">
                         <div class="text-end">
                           <button type="button" (click)="openSupplierModal()" *ngIf="freeze<=4"
                             class="btn btn-outline-primary btn-sm border-0 ms-3">Add
                             Supplier</button>
                         </div>
                       </div>
                     </div>
                   </div>
                   <div class="card-body">
                     <div class="row">
                       <div class="col-12">
                         <table class="table table-striped table-borderless fs-md">
                           <thead class="bg-theme text-white">
                             <tr>
                               <th class="text-start">S.No</th>
                               <th>Seller Name</th>
                               <!-- <th class="text-start">Supplied Qty</th> -->
                               <th class="text-start">Amount</th>
                               <th>Remarks</th>
                               <th class="text-center">Edit / Delete</th>
                             </tr>
                           </thead>
                           <tbody formArrayName="topSellers">
                             <tr *ngFor="let supplier of suppliers.controls; let i = index" [formGroupName]="i">
                               <td class="text-start">{{i + 1}}</td>
                               <td>{{ supplier.get('sellerName')?.value }}</td>
                               <!-- <td class="text-start">{{ supplier.get('suppliedQty')?.value }}</td> -->
                               <td class="text-start">{{ supplier.get('amount')?.value }}</td>
                               <td>{{ supplier.get('remarks')?.value || '-' }}</td>
                               <td class="text-center">
                                 <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="openSupplierModal(i)"
                                   class="btn btn-default text-primary btn-sm">
                                   <span class="bi bi-pencil"></span>
                                 </button>
                                 <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="removeSupplier(i,supplier.get('id')?.value)"
                                   class="btn btn-default text-danger btn-sm">
                                   <span class="bi bi-trash"></span>
                                 </button>
                               </td>
                             </tr>
                             <tr *ngIf="suppliers.controls.length === 0">
                               <td colspan="6" class="text-center py-3 text-muted">No suppliers added yet</td>
                             </tr>
                           </tbody>
                         </table>
                       </div>
                     </div>
                   </div>
                 </div>
                 <div class="text-end">
                   <button type="button" (click)="saveBuyersDetails()" class="btn btn-primary" *ngIf="freeze<=4"
                     [disabled]="basicDetails.invalid">
                     Save Details
                   </button>
                 </div>
                 <!-- Success Messages -->
                 <div *ngIf="saveSuccess.buyers" class="alert alert-success alert-dismissible fade show" role="alert">
                   Buyers information saved successfully!
                   <button type="button" class="btn-close" (click)="saveSuccess.buyers = false"
                     aria-label="Close"></button>
                 </div>

                 <div *ngIf="saveSuccess.suppliers" class="alert alert-success alert-dismissible fade show"
                   role="alert">
                   Suppliers information saved successfully!
                   <button type="button" class="btn-close" (click)="saveSuccess.suppliers = false"
                     aria-label="Close"></button>
                 </div>
               </div>

               <!-- Buyer Modal -->
               <div class="modal fade" [class.show]="showBuyerModal" [style.display]="showBuyerModal ? 'block' : 'none'"
                 id="buyerModal" tabindex="-1" role="dialog" aria-labelledby="buyerModalLabel" aria-hidden="true">
                 <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                   <div class="modal-content">
                     <div class="modal-header py-2 bg-primary text-white">
                       <h6 class="modal-title">{{ isEditMode ? 'Edit' : 'Add' }} Buyer</h6>
                       <button type="button" class="btn-close text-white fs-4 p-0" (click)="closeModalBuyer()"
                         aria-label="Close">
                         <span class="bi bi-x"></span>
                       </button>
                     </div>
                     <div class="modal-body">
                       <form [formGroup]="buyerForm">
                         <div class="row">
                           <div class="col-12 col-sm-6 col-md-6 col-lg-6">
                             <div class="form-floating mb-3">
                               <input type="text" class="form-control" id="buyername" placeholder=""
                                 formControlName="buyerName">
                               <label for="buyername">Buyer Name <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="buyerForm.get('buyerName')?.invalid && (buyerForm.get('buyerName')?.dirty || buyerForm.get('buyerName')?.touched)"
                                 class="text-danger small">
                                 Buyer name is required
                               </div>
                             </div>
                           </div>
                           <!-- <div class="col-12 col-sm-6 col-md-6 col-lg-6">
                             <div class="form-floating mb-3">
                               <input type="number" class="form-control" id="qtypurchased" placeholder=""
                                 formControlName="purchasedQty" min="0">
                               <label for="qtypurchased">Qty Purchased</label>
                               <div
                                 *ngIf="buyerForm.get('purchasedQty')?.invalid && (buyerForm.get('purchasedQty')?.dirty || buyerForm.get('purchasedQty')?.touched)"
                                 class="text-danger small">
                                 Valid quantity required (minimum 1)
                               </div>
                             </div>
                           </div> -->
                           <div class="col-12 col-sm-6 col-md-6 col-lg-6">
                             <div class="form-floating mb-3">
                               <input type="number" class="form-control" id="amt" placeholder=""
                                 formControlName="amount" min="0">
                               <label for="amt">Amount <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="buyerForm.get('amount')?.invalid && (buyerForm.get('amount')?.dirty || buyerForm.get('amount')?.touched)"
                                 class="text-danger small">
                                 Valid amount required
                               </div>
                             </div>
                           </div>
                           <div class="col-12 col-sm-6 col-md-6 col-lg-6">
                             <div class="form-floating mb-3">
                               <input type="text" class="form-control" id="remarks" placeholder=""
                                 formControlName="remarks">
                               <label for="remarks">Remarks</label>
                             </div>
                           </div>
                         </div>
                       </form>
                     </div>
                     <div class="modal-footer">
                       <button type="button" class="btn btn-secondary" (click)="closeModalBuyer()">Cancel</button>
                       <button type="button" class="btn btn-primary" (click)="saveBuyer()"
                         [disabled]="buyerForm.invalid">
                         {{ isEditMode ? 'Update' : 'Save' }}
                       </button>
                     </div>
                   </div>
                 </div>
               </div>

               <!-- Supplier Modal -->
               <div class="modal fade" [class.show]="showSupplierModal"
                 [style.display]="showSupplierModal ? 'block' : 'none'" id="supplierModal" tabindex="-1" role="dialog"
                 aria-labelledby="supplierModalLabel" aria-hidden="true">
                 <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                   <div class="modal-content">
                     <div class="modal-header py-2 bg-primary text-white">
                       <h6 class="modal-title">{{ isEditMode ? 'Edit' : 'Add' }} Supplier</h6>
                       <button type="button" class="btn-close text-white fs-4 p-0" (click)="closeModalBuyer()"
                         aria-label="Close">
                         <span class="bi bi-x"></span>
                       </button>
                     </div>
                     <div class="modal-body">
                       <form [formGroup]="supplierForm">
                         <div class="row">
                           <div class="col-12 col-sm-6 col-md-6 col-lg-6">
                             <div class="form-floating mb-3">
                               <input type="text" class="form-control" id="sellername" placeholder=""
                                 formControlName="sellerName">
                               <label for="sellername">Seller Name <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="supplierForm.get('sellerName')?.invalid && (supplierForm.get('sellerName')?.dirty || supplierForm.get('sellerName')?.touched)"
                                 class="text-danger small">
                                 Seller name is required
                               </div>
                             </div>
                           </div>
                           <!-- <div class="col-12 col-sm-6 col-md-6 col-lg-6">
                             <div class="form-floating mb-3">
                               <input type="number" class="form-control" id="suppliedQty" placeholder=""
                                 formControlName="suppliedQty" min="0">
                               <label for="suppliedQty">Supplied Qty</label>
                               <div
                                 *ngIf="supplierForm.get('suppliedQty')?.invalid && (supplierForm.get('suppliedQty')?.dirty || supplierForm.get('suppliedQty')?.touched)"
                                 class="text-danger small">
                                 Valid quantity required (minimum 1)
                               </div>
                             </div>
                           </div> -->
                           <div class="col-12 col-sm-6 col-md-6 col-lg-6">
                             <div class="form-floating mb-3">
                               <input type="number" class="form-control" id="amtSeller" placeholder=""
                                 formControlName="amount" min="0">
                               <label for="amtSeller">Amount <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="supplierForm.get('amount')?.invalid && (supplierForm.get('amount')?.dirty || supplierForm.get('amount')?.touched)"
                                 class="text-danger small">
                                 Valid amount required
                               </div>
                             </div>
                           </div>
                           <div class="col-12 col-sm-6 col-md-6 col-lg-6">
                             <div class="form-floating mb-3">
                               <input type="text" class="form-control" id="remarksSeller" placeholder=""
                                 formControlName="remarks">
                               <label for="remarksSeller">Remarks</label>
                             </div>
                           </div>
                         </div>
                       </form>
                     </div>
                     <div class="modal-footer">
                       <button type="button" class="btn btn-secondary" (click)="closeModalBuyer()">Cancel</button>
                       <button type="button" class="btn btn-primary" (click)="saveSupplier()"
                         [disabled]="supplierForm.invalid">
                         {{ isEditMode ? 'Update' : 'Save' }}
                       </button>
                     </div>
                   </div>
                 </div>
               </div>

               <!-- Modal Backdrops -->
               <div class="modal-backdrop fade" [class.show]="showBuyerModal || showSupplierModal"
                 [style.display]="showBuyerModal || showSupplierModal ? 'block' : 'none'"></div>
               <!-- end:: Top Buyers/Suppliers details -->

               <!-- begin:: receivables / payables -->

               <div class="tab-pane fade p-2" id="payable" role="tabpanel" aria-labelledby="payable-tab"
                 [ngClass]="{ 'active':currentTab === 'RECEIVABLES_PAYABLES'}"
                 [class.show.active]="currentTab === 'RECEIVABLES_PAYABLES'">

                 <!-- Receivables Card -->
                 <div class="card border rounded-3 mb-3">
                   <div class="card-header bg-transparent">
                     <div class="row align-items-center">
                       <div class="col-12 col-sm-8 col-md-8 col-lg-9 col-xl-9">
                         <label class="fs-md fw-600 mb-0">Receivables</label>
                       </div>
                       <div class="col-12 col-sm-4 col-md-4 col-lg-3 col-xl-3">
                         <div class="text-end">
                           <button type="button" (click)="openReceivableModal()" *ngIf="freeze<=4"
                             class="btn btn-outline-primary btn-sm border-0 ms-3">Add
                             Receivable</button>
                         </div>
                       </div>
                     </div>
                   </div>
                   <div class="card-body">
                     <div class="row">
                       <div class="col-12">
                         <div>
                           <table class="table table-striped table-borderless fs-md">
                           <thead class="bg-theme text-white">
                               <tr>
                                 <th class="text-start">S.No</th>
                                 <th>To be received from</th>
                                 <!-- <th>Receivable Date</th> -->
                                 <th>Receivable Amount</th>
                                 <th class="text-center">Edit / Delete</th>
                               </tr>
                             </thead>
                             <tbody formArrayName="receivables">
                               <tr *ngFor="let receivable of receivables.controls; let i = index" [formGroupName]="i">
                                 <td class="text-start">{{i + 1}}</td>
                                 <td>{{ receivable.get('toBeReceivedFrom')?.value }}</td>
                                 <!-- <td>{{ formatDate(receivable.get('receivableDate')?.value) }}</td> -->
                                 <td>{{ receivable.get('receivableAmount')?.value }}</td>
                                 <td class="text-center">
                                   <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="openReceivableModal(i)"
                                     class="btn btn-default text-primary btn-sm">
                                     <span class="bi bi-pencil"></span>
                                   </button>
                                   <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="removeReceivable(i,receivable.get('id')?.value)"
                                     class="btn btn-default text-danger btn-sm">
                                     <span class="bi bi-trash"></span>
                                   </button>
                                 </td>
                               </tr>
                               <tr *ngIf="receivables.controls.length === 0">
                                 <td colspan="5" class="text-center py-3 text-muted">No receivables added yet</td>
                               </tr>
                             </tbody>
                             <tfoot *ngIf="receivables.controls.length > 0">
                               <tr>
                             
                                 <td></td>
                                 <td>Total</td>
                                 <td>{{ getTotalReceivables() }}</td>
                                 <td></td>
                               </tr>
                             </tfoot>
                           </table>
                         </div>
                       </div>
                     </div>
                   </div>
                 </div>

                 <!-- Payables Card -->
                 <div class="card border rounded-3 mb-3">
                   <div class="card-header bg-transparent">
                     <div class="row align-items-center">
                       <div class="col-12 col-sm-8 col-md-8 col-lg-9 col-xl-9">
                         <label class="fs-md fw-600 mb-0">Payables</label>
                       </div>
                       <div class="col-12 col-sm-4 col-md-4 col-lg-3 col-xl-3">
                         <div class="text-end">
                           <button type="button" (click)="openPayableModal()" *ngIf="freeze<=4"
                             class="btn btn-outline-primary btn-sm border-0 ms-3">Add
                             Payable</button>
                         </div>
                       </div>
                     </div>
                   </div>
                   <div class="card-body">
                     <div class="row">
                       <div class="col-12">
                         <div>
                           <table class="table table-striped table-borderless fs-md">
                           <thead class="bg-theme text-white">
                               <tr>
                                 <th class="text-start">S.No</th>
                                 <th>To be Paid to</th>
                                 <!-- <th>Payable Date</th> -->
                                 <th>Payable Amount</th>
                                 <th class="text-center">Edit / Delete</th>
                               </tr>
                             </thead>
                             <tbody formArrayName="payables">
                               <tr *ngFor="let payable of payables.controls; let i = index" [formGroupName]="i">
                                 <td class="text-start">{{i + 1}}</td>
                                 <td>{{ payable.get('toBePaidTo')?.value }}</td>
                                 <!-- <td>{{ formatDate(payable.get('payableDate')?.value) }}</td> -->
                                 <td>{{ payable.get('payableAmount')?.value }}</td>
                                 <td class="text-center">
                                   <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="openPayableModal(i)"
                                     class="btn btn-default text-primary btn-sm">
                                     <span class="bi bi-pencil"></span>
                                   </button>
                                   <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="removePayable(i,payable.get('id')?.value)"
                                     class="btn btn-default text-danger btn-sm">
                                     <span class="bi bi-trash"></span>
                                   </button>
                                 </td>
                               </tr>
                               <tr *ngIf="payables.controls.length === 0">
                                 <td colspan="5" class="text-center py-3 text-muted">No payables added yet</td>
                               </tr>
                             </tbody>
                             <tfoot *ngIf="payables.controls.length > 0">
                               <tr>
                               
                                 <td></td>
                                 <td>Total</td>
                                 <td>{{ getTotalPayables() }}</td>
                                 <td></td>
                               </tr>
                             </tfoot>
                           </table>
                         </div>
                       </div>
                     </div>
                   </div>
                 </div>
                 <div class="text-end">
                   <button type="button" (click)="saveReceivaablesDetails()" class="btn btn-primary" *ngIf="freeze<=4"
                     [disabled]="basicDetails.invalid">
                     Save Details
                   </button>
                 </div>
                 <!-- Success Messages -->
                 <div *ngIf="saveSuccess.receivables" class="alert alert-success alert-dismissible fade show"
                   role="alert">
                   Receivable information saved successfully!
                   <button type="button" class="btn-close" (click)="saveSuccess.receivables = false"
                     aria-label="Close"></button>
                 </div>

                 <div *ngIf="saveSuccess.payables" class="alert alert-success alert-dismissible fade show" role="alert">
                   Payable information saved successfully!
                   <button type="button" class="btn-close" (click)="saveSuccess.payables = false"
                     aria-label="Close"></button>
                 </div>
               </div>

               <!-- Receivable Modal -->
               <div class="modal fade" [class.show]="showReceivableModal"
                 [style.display]="showReceivableModal ? 'block' : 'none'" id="receivableModal" tabindex="-1"
                 role="dialog" aria-labelledby="receivableModalLabel" aria-hidden="true">
                 <div class="modal-dialog modal-dialog-centered" role="document">
                   <div class="modal-content">
                     <div class="modal-header py-1 bg-primary text-white">
                       <h6 class="modal-title">{{ isEditMode ? 'Edit' : 'Add' }} Receivable</h6>
                       <button type="button" class="btn-close text-white fs-4 p-0" (click)="closeModalReceivalbale()"
                         aria-label="Close">
                         <span class="bi bi-x"></span>
                       </button>
                     </div>
                     <div class="modal-body">
                       <form [formGroup]="receivableForm">
                         <div class="row">
                           <div class="col-12">
                             <div class="form-floating mb-3">
                               <input type="text" class="form-control" id="toReceived" placeholder=""
                                 formControlName="toBeReceivedFrom">
                               <label for="toReceived">To be received from <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="receivableForm.get('toBeReceivedFrom')?.invalid && (receivableForm.get('toBeReceivedFrom')?.dirty || receivableForm.get('toBeReceivedFrom')?.touched)"
                                 class="text-danger small">
                                 This field is required
                               </div>
                             </div>
                           </div>
                           <!-- <div class="col-12">
                             <div class="form-floating mb-3">
                               <input type="date" class="form-control" id="receivableDate" placeholder=""  max="{{ today | date:'yyyy-MM-dd' }}"
                                 formControlName="receivableDate">
                               <label for="receivableDate">Receivable Date</label>
                               <div
                                 *ngIf="receivableForm.get('receivableDate')?.invalid && (receivableForm.get('receivableDate')?.dirty || receivableForm.get('receivableDate')?.touched)"
                                 class="text-danger small">
                                 Date is required
                               </div>
                             </div>
                           </div> -->
                           <div class="col-12">
                             <div class="form-floating mb-3">
                               <input type="number" class="form-control" id="receivableAmount" placeholder=""
                                 formControlName="receivableAmount" min="0">
                               <label for="receivableAmount">Receivable Amount <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="receivableForm.get('receivableAmount')?.invalid && (receivableForm.get('receivableAmount')?.dirty || receivableForm.get('receivableAmount')?.touched)"
                                 class="text-danger small">
                                 Valid amount required (minimum 0)
                               </div>
                             </div>
                           </div>
                         </div>
                       </form>
                     </div>
                     <div class="modal-footer">
                       <button type="button" class="btn btn-secondary"
                         (click)="closeModalReceivalbale()">Cancel</button>
                       <button type="button" class="btn btn-primary" (click)="saveReceivable()"
                         [disabled]="receivableForm.invalid">
                         {{ isEditMode ? 'Update' : 'Save' }}
                       </button>
                     </div>
                   </div>
                 </div>
               </div>

               <!-- Payable Modal -->
               <div class="modal fade" [class.show]="showPayableModal"
                 [style.display]="showPayableModal ? 'block' : 'none'" id="payableModal" tabindex="-1" role="dialog"
                 aria-labelledby="payableModalLabel" aria-hidden="true">
                 <div class="modal-dialog modal-dialog-centered" role="document">
                   <div class="modal-content">
                     <div class="modal-header py-1 bg-primary text-white">
                       <h6 class="modal-title">{{ isEditMode ? 'Edit' : 'Add' }} Payable</h6>
                       <button type="button" class="btn-close text-white fs-4 p-0" (click)="closeModalReceivalbale()"
                         aria-label="Close">
                         <span class="bi bi-x"></span>
                       </button>
                     </div>
                     <div class="modal-body">
                       <form [formGroup]="payableForm">
                         <div class="row">
                           <div class="col-12">
                             <div class="form-floating mb-3">
                               <input type="text" class="form-control" id="toPaid" placeholder=""
                                 formControlName="toBePaidTo">
                               <label for="toPaid">To be Paid to <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="payableForm.get('toBePaidTo')?.invalid && (payableForm.get('toBePaidTo')?.dirty || payableForm.get('toBePaidTo')?.touched)"
                                 class="text-danger small">
                                 This field is required
                               </div>
                             </div>
                           </div>
                           <!-- <div class="col-12">
                             <div class="form-floating mb-3">
                               <input type="date" class="form-control" id="payablesDate" placeholder="" max="{{ today | date:'yyyy-MM-dd' }}"
                                 formControlName="payableDate">
                               <label for="payablesDate">Payable Date</label>
                               <div
                                 *ngIf="payableForm.get('payableDate')?.invalid && (payableForm.get('payableDate')?.dirty || payableForm.get('payableDate')?.touched)"
                                 class="text-danger small">
                                 Date is required
                               </div>
                             </div>
                           </div> -->
                           <div class="col-12">
                             <div class="form-floating mb-3">
                               <input type="number" class="form-control" id="payablesAmount" placeholder=""
                                 formControlName="payableAmount" min="0">
                               <label for="payablesAmount">Payable Amount <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="payableForm.get('payableAmount')?.invalid && (payableForm.get('payableAmount')?.dirty || payableForm.get('payableAmount')?.touched)"
                                 class="text-danger small">
                                 Valid amount required (minimum 0)
                               </div>
                             </div>
                           </div>
                         </div>
                       </form>
                     </div>
                     <div class="modal-footer">
                       <button type="button" class="btn btn-secondary"
                         (click)="closeModalReceivalbale()">Cancel</button>
                       <button type="button" class="btn btn-primary" (click)="savePayable()"
                         [disabled]="payableForm.invalid">
                         {{ isEditMode ? 'Update' : 'Save' }}
                       </button>
                     </div>
                   </div>
                 </div>
               </div>

               <!-- Modal Backdrops -->
               <div class="modal-backdrop fade" [class.show]="showReceivableModal || showPayableModal"
                 [style.display]="showReceivableModal || showPayableModal ? 'block' : 'none'"></div>
               <!-- end:: receivables / payables -->

               <!-- Loans Modal -->
               <!-- starts:: operational status -->
               <div class="tab-pane fade p-2" id="operational" role="tabpanel" aria-labelledby="operational-tab"
                 [class.show.active]="currentTab === 'OPERATIONAL_STATUS'"
                 [ngClass]="{ 'active': currentTab === 'OPERATIONAL_STATUS' }">
                 <form [formGroup]="operationalStatus">
                   <div>
                     <label class="fs-md fw-600">Number Of Employees Working</label>
                     <div class="row">
                       <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="number" class="form-control" id="skilled" placeholder=""
                             formControlName="skilledCount" min="0">
                           <label for="skilled">Skilled</label>
                         </div>
                         <div
                           *ngIf="operationalStatus.get('skilledCount')?.invalid && operationalStatus.get('skilledCount')?.touched"
                           class="text-danger small">
                           Skilled is required and Must be a positive number
                         </div>
                       </div>
                       <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="number" class="form-control" id="unskilled" placeholder=""
                             formControlName="unskilledCount" min="0">
                           <label for="unskilled">Unskilled</label>
                         </div>
                         <div
                           *ngIf="operationalStatus.get('unskilledCount')?.invalid && operationalStatus.get('unskilledCount')?.touched"
                           class="text-danger small">
                           Unskilled is required and Must be a positive number
                         </div>
                       </div>
                       <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="number" class="form-control" id="female" placeholder=""
                             formControlName="femaleCount" min="0">
                           <label for="female">Female</label>
                         </div>
                         <div
                           *ngIf="operationalStatus.get('femaleCount')?.invalid && operationalStatus.get('femaleCount')?.touched"
                           class="text-danger small">
                           Female is required and Must be a positive number
                         </div>
                       </div>
                     </div>
                   </div>
                   <div>
                     <label class="fs-md fw-600">Capacity Utilization</label>
                     <div class="row">
                       <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="number" class="form-control" id="installed" placeholder=""
                             formControlName="installedCapacity" min="0" max="100">
                           <label for="installed">Installed %</label>
                         </div>
                         <div
                           *ngIf="operationalStatus.get('installedCapacity')?.invalid && operationalStatus.get('installedCapacity')?.touched"
                           class="text-danger small">
                           Must be a positive number and Not Greater than 100
                         </div>
                       </div>
                       <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="number" class="form-control" id="utilisation" placeholder=""
                             formControlName="utilizedCapacity" min="0" max="100">
                           <label for="utilisation">Utilisation %</label>
                         </div>
                         <div
                           *ngIf="operationalStatus.get('utilizedCapacity')?.invalid && operationalStatus.get('utilizedCapacity')?.touched"
                           class="text-danger small">
                           Must be a positive number and Not Greater than 100
                         </div>
                       </div>
                       <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                         <div class="form-floating mb-3">
                           <input type="text" class="form-control" id="observation" placeholder=""
                             formControlName="observation">
                           <label for="observation">Observation</label>
                         </div>
                       </div>
                     </div>
                   </div>
                   <div class="border rounded-3 p-2 mb-3">
                     <!-- <div>
                       <div class="form-check form-check-inline">
                         <input class="form-check-input" type="radio" formControlName="isWorking" id="working"
                           (change)="changesdata('Yes')" [value]="true">
                         <label class="form-check-label fs-md" for="working">Working</label>
                       </div>
                       <div class="form-check form-check-inline">
                         <input class="form-check-input" type="radio" formControlName="isWorking" id="notWorking"
                           (change)="changesdata('No')" [value]="false">
                         <label class="form-check-label fs-md" for="notWorking">Not Working</label>
                       </div>
                     </div> -->
                     <div class="show-hide1 mt-3" *ngIf="operationalStatus.get('isWorking')?.value" id="workingStatus">
                       <div class="border p-2 rounded-3 mb-3">
                         <div class="row align-items-center">
                           <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
                             <label class="fs-md fw-bold mb-1">Order Book Position</label>
                           </div>
                           <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
                             <div class="text-start text-sm-end text-xl-end">
                               <button type="button" (click)="openOrderBookModal()" *ngIf="freeze<=4"
                                 class="btn btn-outline-primary btn-sm border-0 ms-3">
                                 <span class="bi bi-plus-lg"></span> Add
                               </button>
                             </div>
                           </div>
                         </div>

                         <div class="table-responsive mt-3">
                           <table class="table table-striped table-borderless fs-md">
                             <thead class="bg-theme text-white">
                               <tr>
                                 <th>S.No</th>
                                 <!-- <th>Date of Order</th> -->
                                 <th>Name Of The Buyer</th>
                                 <th>Order Value</th>
                                 <th>Remarks</th>
                                 <th class="text-center">Actions</th>
                               </tr>
                             </thead>
                             <tbody>
                               <tr *ngFor="let position of orderBookPositions.controls; let i = index">
                                 <td>{{i + 1}}</td>
                                 <!-- <td>{{position.get('dateOfOrder')?.value | date:'dd-MM-yyyy'}}</td> -->
                                 <td>{{position.get('nameOfTheBuyer')?.value}}</td>
                                 <td>{{position.get('orderValue')?.value | number}}</td>
                                 <td>{{position.get('remarks')?.value}}</td>
                                 <td class="text-center">
                                   <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="editOrderBookPosition(i)"
                                     class="btn btn-sm btn-outline-primary me-2">
                                     <i class="bi bi-pencil"></i>
                                   </button>
                                   <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="removeOrderBookPosition(i,position.get('id')?.value)"
                                     class="btn btn-sm btn-outline-danger">
                                     <i class="bi bi-trash"></i>
                                   </button>
                                 </td>
                               </tr>
                               <tr *ngIf="orderBookPositions.length === 0">
                                 <td colspan="6" class="text-center">No order book positions added yet</td>
                               </tr>
                             </tbody>
                             <tfoot *ngIf="orderBookPositions.length > 0">
                               <tr>
                                 <td colspan="2" class="text-end fw-bold">Total Order Value:</td>
                                 <td class="fw-bold">{{getTotalOrderValue() | number}}</td>
                                 <td colspan="2"></td>
                               </tr>
                             </tfoot>
                           </table>
                         </div>
                       </div>

                       <div class="mb-3">
                         <div class="row">
                           <div class="col-12 col-sm-6 col-md-3 col-lg-2">
                             <label class="fs-md fw-600">Unsecured Loans</label>
                           </div>
                           <div class="col-12 col-sm-6 col-md-9 col-lg-10">
                             <div class="form-check form-check-inline">
                               <input class="form-check-input" type="radio" formControlName="hasUnsecuredLoans" id="yes"
                                 (change)="changesdata()" [value]="true"
                                 (change)="operationalStatus.get('hasUnsecuredLoans')?.value">
                               <label class="form-check-label fs-md" for="yes">Yes</label>
                             </div>
                             <div class="form-check form-check-inline">
                               <input class="form-check-input" type="radio" formControlName="hasUnsecuredLoans"
                                 (change)="changesdata()" id="nounsecured" [value]="false">
                               <label class="form-check-label fs-md" for="nounsecured">No</label>
                             </div>
                           </div>
                         </div>
                         <div class="show-hide2" *ngIf="operationalStatus.get('hasUnsecuredLoans')?.value">
                           <div class="border rounded-3 p-3 mt-2">
                             <div class="row">
                               <div class="col-12">
                                 <div class="text-end mb-2">
                                   <button type="button" (click)="openUnsecuredLoansModal()" *ngIf="freeze<=4"
                                     class="btn btn-outline-primary btn-sm border-0 ms-3">
                                     <span class="bi bi-plus-lg"></span> Add Loan
                                   </button>
                                 </div>
                               </div>
                               <div class="col-12">
                                 <table class="table table-striped table-borderless fs-md">
                                    <thead class="bg-theme text-white">
                                     <tr>
                                       <th class="text-start">S.No</th>
                                       <th>Source</th>
                                       <th class="text-start">Loan Amount</th>
                                       <th class="text-start">Since when/Sanctioned date</th>
                                       <th>Tenor</th>
                                       <th class="text-center">Actions</th>
                                     </tr>
                                   </thead>
                                   <tbody>
                                     <tr *ngFor="let loan of unsecuredLoans.controls; let i = index">
                                       <td class="text-start">{{i + 1}}</td>
                                       <td>{{loan.get('source')?.value}}</td>
                                       <td class="text-start">{{loan.get('loanAmount')?.value | number}}</td>
                                       <td class="text-start">{{loan.get('sinceWhen')?.value | date:'dd-MM-yyyy'}}</td>
                                       <td>{{loan.get('tenor')?.value || '-'}}</td>
                                       <td class="text-center">
                                         <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="editUnsecuredLoan(i)"
                                           class="btn btn-sm btn-outline-primary me-2">
                                           <i class="bi bi-pencil"></i>
                                         </button>
                                         <button type="button" [ngClass]="{'isDisabled':!(freeze<=4)}" (click)="removeUnsecuredLoan(i,loan.get('id')?.value)"
                                           class="btn btn-sm btn-outline-danger">
                                           <i class="bi bi-trash"></i>
                                         </button>
                                       </td>
                                     </tr>
                                     <tr *ngIf="unsecuredLoans.length === 0">
                                       <td colspan="6" class="text-center">No unsecured loans added yet</td>
                                     </tr>
                                   </tbody>
                                 </table>
                               </div>
                             </div>
                           </div>
                         </div>
                       </div>

                       <div class="mb-3">
                         <label class="fs-md fw-600 mb-2">Financial Requirement</label>
                         <div class="row">
                           <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                             <label class="fs-md fw-600">How much loan is required</label>
                           </div>
                           <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                             <!-- <input type="text" class="form-control form-control-sm" placeholder="Loan"> -->
                             <input type="number" class="form-control" placeholder=""
                               formControlName="requiredLoanAmount" min="0">
                           </div>
                         </div>
                       </div>

                       <div class="mb-3">
                         <div>
                           <label class="d-block fs-md fw-600 mb-1">Security for Loan</label>
                           <div class="form-check form-check-inline">
                             <input class="form-check-input" type="radio" formControlName="loanSecurityType"
                               (change)="changesdata()" id="pendingSubsidy" value=" Pending subsidies/Incentives">
                             <label class="form-check-label" for="pendingSubsidy">Pending subsidies/Incentives</label>
                           </div>
                           <div class="form-check form-check-inline">
                             <input class="form-check-input" type="radio" formControlName="loanSecurityType"
                               (change)="changesdata()" id="residential" value="Residential Property">
                             <label class="form-check-label" for="residential">Residential Property</label>
                           </div>
                           <div class="form-check form-check-inline">
                             <input class="form-check-input" type="radio" formControlName="loanSecurityType"
                               (change)="changesdata()" id="security" value="No Security">
                             <label class="form-check-label" for="security">No Security</label>
                           </div>
                           <div class="form-check form-check-inline">
                             <input class="form-check-input" type="radio" formControlName="loanSecurityType"
                               (change)="changesdata()" id="paripassu" value="Paripassu">
                             <label class="form-check-label" for="paripassu">Paripassu</label>
                           </div>
                           <div class="form-check form-check-inline">
                             <input class="form-check-input" type="radio" formControlName="loanSecurityType"
                               (change)="changesdata()" id="othersLoan" value="Others">
                             <label class="form-check-label" for="othersLoan">Others</label>
                           </div>
                           <div class="form-check form-check-inline">
                             <input class="form-check-input" type="radio" formControlName="loanSecurityType"
                               (change)="changesdata()" id="commercialPropertyLoan" value="Commercial Property">
                             <label class="form-check-label" for="commercialPropertyLoan">Commercial Property</label>
                           </div>
                         </div>

                         <div class="show-hide3 mt-3"
                           *ngIf="operationalStatus.get('loanSecurityType')?.value === ' Pending subsidies/Incentives'">
                           <label class="d-block fs-md fw-600 mb-1">If Pending subsidies/Incentives is selected</label>
                           <div class="form-check form-check-inline">
                             <input class="form-check-input" type="radio" formControlName="subsidyType" id="modalTPride"
                               value="T-Pride">
                             <label class="form-check-label" for="modalTPride">T-Pride</label>
                           </div>
                           <div class="form-check form-check-inline">
                             <input class="form-check-input" type="radio" formControlName="subsidyType" id="modalTIdeal"
                               value="T-Ideal">
                             <label class="form-check-label" for="modalTIdeal">T-IDEA</label>
                           </div>


                           <div class="row mt-3">
                             <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                               <label class="fs-md fw-600">Subsidy Amount Pending</label>
                             </div>
                             <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                               <input type="number" class="form-control" id="modalSubsidyAmount"
                                 formControlName="subsidyAmountPending" min="0">
                             </div>
                           </div>
                         </div>
                         <div class="show-hide3 mt-3"
                           *ngIf="operationalStatus.get('loanSecurityType')?.value === 'Others'">
                           <textarea class="form-control" id="modalOtherSecurity" formControlName="othersType"
                             style="height: 100px"></textarea>
                         </div>
                       </div>

                       <div class="mb-3">
                         <div class="row">
                           <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                             <label class="fs-md fw-600">Any Statutory Due Pending</label>
                           </div>
                           <div class="col-12 col-sm-6 col-md-4 col-lg-9">
                             <div class="form-check form-check-inline">
                               <input class="form-check-input" type="radio" name="hasStatutoryDuePending" id="yesLoan"
                                 (change)="changesdata()" formControlName="hasStatutoryDuePending" [value]="true">
                               <label class="form-check-label fs-md" for="yesLoan">Yes</label>
                             </div>
                             <div class="form-check form-check-inline">
                               <input class="form-check-input" type="radio" name="hasStatutoryDuePending" id="noLoan"
                                 (change)="changesdata()" formControlName="hasStatutoryDuePending" [value]="false">
                               <label class="form-check-label fs-md" for="noLoan">No</label>
                             </div>
                           </div>
                         </div>
                         <div class="show-hide4 mt-3" *ngIf="operationalStatus.get('hasStatutoryDuePending')?.value">
                           <textarea class="form-control" rows="5" placeholder="Details"
                             formControlName="statutoryDetails"></textarea>
                         </div>
                       </div>
                     </div>

                   </div>
                   <div class="text-end">
                     <button type="button" (click)="saveOperationalStatus()" class="btn btn-primary" *ngIf="freeze<=4"
                       [disabled]="operationalStatus.invalid">
                       Save Operational Status
                     </button>
                   </div>
                 </form>

               </div>


               <!-- Order Book Position Modal -->
               <div class="modal fade" [class.show]="orderBookPositionsModal"
                 [style.display]="orderBookPositionsModal ? 'block' : 'none'" tabindex="-1"
                 aria-labelledby="orderBookModalLabel" aria-hidden="true">
                 <div class="modal-dialog modal-dialog-centered">
                   <div class="modal-content">
                     <div class="modal-header py-1 bg-theme text-white">
                       <h6 class="modal-title">{{isEditingOrderBook ? 'Edit' : 'Add'}} Order Book Position</h6>
                       <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal"
                         (click)=" this.closeOperationalModals()" aria-label="Close">
                         <span class="bi bi-x"></span>
                       </button>
                     </div>
                     <div class="modal-body">
                       <form [formGroup]="orderBookForm">
                         <div class="row mb-3">
                           <!-- <div class="col-md-12">
                             <div class="form-floating">
                               <input type="date" class="form-control" id="modalDateOfOrder"
                                 max="{{ today | date:'yyyy-MM-dd' }}" formControlName="dateOfOrder">
                               <label for="modalDateOfOrder">Date of Order</label>
                             </div>
                           </div> -->
                         </div>

                         <div class="row mb-3">
                           <div class="col-md-12">
                             <div class="form-floating">
                               <input type="text" class="form-control" id="modalCustomerName"
                                 formControlName="nameOfTheBuyer">
                               <label for="modalCustomerName">Name Of The Buyer <span class="text-danger">*</span></label>
                             </div>
                           </div>
                         </div>

                         <div class="row mb-3">
                           <div class="col-md-12">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="modalOrderValue"
                                 formControlName="orderValue" min="0">
                               <label for="modalOrderValue">Order Value <span class="text-danger">*</span></label>
                             </div>
                           </div>
                         </div>

                         <div class="row mb-3">
                           <div class="col-md-12">
                             <div class="form-floating">
                               <input type="text" class="form-control" id="Remarks"formControlName="remarks">
                               <label for="Remarks">Remarks</label>
                             </div>
                           </div>
                         </div>
                       </form>
                     </div>
                     <div class="modal-footer">
                       <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                         (click)=" this.closeOperationalModals()">Cancel</button>
                       <button type="button" class="btn btn-primary" (click)="saveOrderBookPosition()"
                         [disabled]="orderBookForm.invalid">
                         {{isEditingOrderBook ? 'Update' : 'Save'}}
                       </button>
                     </div>
                   </div>
                 </div>
               </div>

               <!-- Unsecured Loans Modal -->
               <div class="modal fade" [class.show]="unsecuredLoansModal"
                 [style.display]="unsecuredLoansModal ? 'block' : 'none'" tabindex="-1"
                 aria-labelledby="unsecuredLoansModalLabel" aria-hidden="true">
                 <div class="modal-dialog modal-dialog-centered">
                   <div class="modal-content">
                     <div class="modal-header py-1 bg-theme text-white">
                       <h6 class="modal-title">{{isEditingUnsecuredLoan ? 'Edit' : 'Add'}} Unsecured Loan</h6>
                       <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal"
                         aria-label="Close" (click)=" this.closeOperationalModals()">
                         <span class="bi bi-x"></span>
                       </button>
                     </div>
                     <div class="modal-body">
                       <form [formGroup]="unsecuredLoansForm">
                         <div class="row mb-3">
                           <div class="col-md-12">
                             <div class="form-floating">
                               <input type="text" class="form-control" id="modalLoanSource" formControlName="source">
                               <label for="modalLoanSource">Source <span class="text-danger">*</span></label>
                             </div>
                           </div>
                         </div>

                         <div class="row mb-3">
                           <div class="col-md-12">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="modalLoanAmount"
                                 formControlName="loanAmount" min="0">
                               <label for="modalLoanAmount">Loan Amount <span class="text-danger">*</span></label>
                             </div>
                           </div>
                         </div>

                         <div class="row mb-3">
                           <div class="col-md-12">
                             <div class="form-floating">
                               <input type="date" class="form-control" id="modalSinceWhen" formControlName="sinceWhen"
                                 max="{{ today | date:'yyyy-MM-dd' }}">
                               <label for="modalSinceWhen">Since when/Sanctioned date <span class="text-danger">*</span></label>
                             </div>
                           </div>
                         </div>

                         <div class="row mb-3">
                           <div class="col-md-12">
                             <div class="form-floating">
                               <textarea class="form-control" id="tenor" formControlName="tenor"
                                 style="height: 80px"></textarea>
                               <label for="tenor">Tenor</label>
                             </div>
                           </div>
                         </div>
                       </form>
                     </div>
                     <div class="modal-footer">
                       <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                         (click)=" this.closeOperationalModals()">Cancel</button>
                       <button type="button" class="btn btn-primary" (click)="saveUnsecuredLoan()"
                         [disabled]="unsecuredLoansForm.invalid">
                         {{isEditingUnsecuredLoan ? 'Update' : 'Save'}}
                       </button>
                     </div>
                   </div>
                 </div>
               </div>

               <!-- end:: operational status -->

               <!-- begin:: Reasons for Stress questions -->
               <div class="tab-pane fade p-2" id="salesissue" role="tabpanel" aria-labelledby="salesissue-tab"
                 [class.show.active]="currentTab === 'REASONS_FOR_STRESS'"
                 [ngClass]="{ 'active': currentTab === 'REASONS_FOR_STRESS' }">
                 <!-- Reasons for Stress Tab -->
                 <div>
                   <label class="fs-md fw-600 mb-2">Reasons for Stress</label>
                   <textarea class="form-control" rows="5" placeholder="Write Reason here"
                     formControlName="reasonForStress"></textarea>
                 </div>

                 <div class="text-end mt-3">
                   <button type="button" (click)="saveStressReason()" class="btn btn-primary" *ngIf="freeze<=4">
                     Save Reason
                   </button>
                   <div *ngIf="saveSuccess.stress" class="text-success small mt-2">
                     Reason saved successfully!
                   </div>
                 </div>
               </div>
               <!-- end:: Reasons for Stress -->

               <!-- begin:: balance Sheet -->
               <div class="tab-pane fade p-2" id="balancesheet" role="tabpanel" aria-labelledby="balancesheet-tab"
                 [class.show.active]="currentTab === 'BALANCE_SHEET'"
                 [ngClass]="{ 'active': currentTab === 'BALANCE_SHEET' }">
                 <div class="card border rounded-3 mb-3">
                   <div class="card-header bg-transparent">
                     <div class="card-header bg-transparent">
                       <div class="row align-items-center">
                         <div class="col-12 col-sm-8 col-md-8 col-lg-9 col-xl-9">
                           <label class="fs-md fw-600 mb-0">Balance Sheet</label>
                         </div>
                         <div class="col-12 col-sm-4 col-md-4 col-lg-3 col-xl-3">
                           <div class="text-end">
                             <button type="button" (click)="openBalancesheetModal()" *ngIf="freeze<=4"
                               class="btn btn-outline-primary btn-sm border-0 ms-3">Add</button>
                           </div>
                         </div>
                       </div>
                     </div>
                   </div>
                   <div class="card-body">
                     <div class="row mb-3">
                       <div class="col-12">
                         <table class="table table-striped table-borderless fs-md">
                           <thead class="bg-theme text-white">
                             <tr>
                               <th class="text-start">S.No</th>
                               <th>Parameter</th>
                               <th *ngFor="let data of BalnceShetData">{{data?.financialYear}} ({{data?.balanceSheetType}})</th>

                             </tr>
                           </thead>
                           <tbody>
                             <tr>
                               <td class="text-start"> 1</td>
                               <td>Total Receipts</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.totalReceipts}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">2</td>
                               <td>Turnover as per bank statement</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.turnoverAsPerBankStatement}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">3</td>
                               <td>Net Profit / Loss</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.netProfitOrLoss}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">4</td>
                               <td>Cash Profit / Loss</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.cashProfitOrLoss}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">5</td>
                               <td>Sundry Creditors</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.sundryCreditors}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">6</td>
                               <td>Sundry Debtors</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.sundryDebtors}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">7</td>
                               <td>Unsecured Loans</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.unsecuredLoans}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">8</td>
                               <td>Net Add cap infused other than internal accural</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.netAddCapInfused}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">9</td>
                               <td>TOL</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.tol}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">10</td>
                               <td>TNW</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.tnw}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">11</td>
                               <td>TOL / TNW</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.tolTnwRatio}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">12</td>
                               <td>Current Assets</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.currentAssets}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">13</td>
                               <td>Current Liabilities</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.currentLiabilities}}</td>
                             </tr>
                             <tr>
                               <td class="text-start">14</td>
                               <td>Current Ratios</td>
                               <td *ngFor="let data of BalnceShetData">{{data?.currentRatio}}</td>
                             </tr>
                           </tbody>
                         </table>
                       </div>
                     </div>
                     <div>
                        <div class="text-end">
                          <button type="button" [ngClass]="{'disabled':BalnceShetData?.length==0}" (click)="nextsteptoBalancesheeet()" *ngIf="freeze<=4"
                            class="btn btn-primary">Save</button>
                        </div>
                     </div>
                   </div>
                 </div>


               </div>
               <div class="modal fade" id="orderBook" tabindex="-1" aria-labelledby="orderBookLabel" aria-hidden="true"
                 [class.show]="showbalanceSheetsModal" [style.display]="showbalanceSheetsModal ? 'block' : 'none'">
                 <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
                   <div class="modal-content">
                     <div class="modal-header py-2 bg-theme">
                       <h6 class="modal-title text-white">
                         {{ isEditMode ? 'Edit' : 'Add' }} Balance Sheet
                       </h6>
                       <button type="button" class="btn-close text-white fs-4 p-0" (click)="closeModalBalancesheet()"
                         aria-label="Close">
                         <span class="bi bi-x"></span>
                       </button>
                     </div>

                     <div class="modal-body">
                       <form [formGroup]="balanceSheetsForm" (ngSubmit)="onSubmit()">
                         <div class="row">
                           <!-- Report Date -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="date" class="form-control" id="reportDate" formControlName="reportDate"
                                 max="{{ today | date:'yyyy-MM-dd' }}">
                               <label for="reportDate">Report Date <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="balanceSheetsForm.get('reportDate')?.invalid && balanceSheetsForm.get('reportDate')?.touched"
                                 class="text-danger small">
                                 Report Date is required
                               </div>
                             </div>
                           </div>

                           <!-- Financial Year -->

                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating mb-3">
                               <select class="form-select" id="financialYear" formControlName="financialYear">
                                 <option *ngFor="let val of this.financialYears" value="{{val}}">{{val}}</option>
                               </select>
                               <label for="financialYear" style="font-weight: 600;">Financial Year <span class="text-danger">*</span></label>
                               <div
                                 *ngIf="balanceSheetsForm.get('financialYear')?.invalid && balanceSheetsForm.get('financialYear')?.touched"
                                 class="text-danger small">
                                 Financial Year is required
                               </div>
                             </div>
                           </div>
                            <div class="col-12 col-md-6 mb-3">
                             <div class="form-check form-check-inline">
                               <input class="form-check-input" type="radio" formControlName="balanceSheetType" id="yes" value="Audited" >
                               <label class="form-check-label fs-md" for="yes">Audited</label>
                             </div>
                             <div class="form-check form-check-inline">
                               <input class="form-check-input" type="radio" formControlName="balanceSheetType" id="nounsecured" value="Provisional">
                               <label class="form-check-label fs-md" for="nounsecured">Provisional</label>
                             </div>
                           </div>

                           <!-- Total Receipts -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="totalReceipts"
                                 formControlName="totalReceipts" min="0">
                               <label for="totalReceipts">Total Receipts</label>
                               <div *ngIf="balanceSheetsForm.get('totalReceipts')?.invalid" class="text-danger small">
                                 Must be a positive number
                               </div>
                             </div>
                           </div>

                           <!-- Turnover As Per Bank Statement -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="turnoverAsPerBankStatement"
                                 formControlName="turnoverAsPerBankStatement" min="0">
                               <label for="turnoverAsPerBankStatement">Turnover (Bank Statement)</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('turnoverAsPerBankStatement')?.invalid"
                               class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- Net Profit/Loss -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="netProfitOrLoss"
                                 formControlName="netProfitOrLoss">
                               <label for="netProfitOrLoss">Net Profit/Loss</label>
                             </div>

                           </div>

                           <!-- Cash Profit/Loss -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="cashProfitOrLoss"
                                 formControlName="cashProfitOrLoss">
                               <label for="cashProfitOrLoss">Cash Profit/Loss</label>
                             </div>
                           </div>

                           <!-- Sundry Creditors -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="sundryCreditors"
                                 formControlName="sundryCreditors" min="0">
                               <label for="sundryCreditors">Sundry Creditors</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('sundryCreditors')?.invalid" class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- Sundry Debtors -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="sundryDebtors"
                                 formControlName="sundryDebtors" min="0">
                               <label for="sundryDebtors">Sundry Debtors</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('sundryDebtors')?.invalid" class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- Unsecured Loans -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="unsecuredLoans"
                                 formControlName="unsecuredLoans" min="0">
                               <label for="unsecuredLoans">Unsecured Loans</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('unsecuredLoans')?.invalid" class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- Net Additional Capital Infused -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="netAddCapInfused"
                                 formControlName="netAddCapInfused" min="0">
                               <label for="netAddCapInfused">Net Additional Capital Infused</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('netAddCapInfused')?.invalid" class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- TOL -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="tol" formControlName="tol" min="0">
                               <label for="tol">Total Outside Liabilities (TOL)</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('tol')?.invalid" class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- TNW -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="tnw" formControlName="tnw" min="0">
                               <label for="tnw">Tangible Net Worth (TNW)</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('tnw')?.invalid" class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- TOL/TNW Ratio -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="tolTnwRatio" formControlName="tolTnwRatio"
                                 readonly>
                               <label for="tolTnwRatio">TOL/TNW Ratio</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('tolTnwRatio')?.invalid" class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- Current Assets -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="currentAssets"
                                 formControlName="currentAssets" min="0">
                               <label for="currentAssets">Current Assets</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('currentAssets')?.invalid" class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- Current Liabilities -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="currentLiabilities"
                                 formControlName="currentLiabilities" min="0">
                               <label for="currentLiabilities">Current Liabilities</label>
                             </div>
                             <div *ngIf="balanceSheetsForm.get('currentLiabilities')?.invalid"
                               class="text-danger small">
                               Must be a positive number
                             </div>
                           </div>

                           <!-- Current Ratio -->
                           <div class="col-12 col-md-6 mb-3">
                             <div class="form-floating">
                               <input type="number" class="form-control" id="currentRatio"
                                 formControlName="currentRatio" readonly>
                               <label for="currentRatio">Current Ratio</label>
                             </div>
                           </div>
                         </div>

                         <div class="text-end mt-3">
                           <button type="button" class="btn btn-secondary me-2"
                             (click)="closeModalBalancesheet()">Cancel</button>
                           <button type="submit" class="btn btn-primary">
                             {{ isEditMode ? 'Update' : 'Add' }}
                           </button>
                         </div>
                       </form>
                     </div>
                   </div>
                 </div>
               </div>
               <div class="modal-backdrop fade" [class.show]="showbalanceSheetsModal"
                 [style.display]="showbalanceSheetsModal ? 'block' : 'none'"></div>
               <!-- end:: balance Sheet -->

               <!-- begin:: status update -->
               <div class="tab-pane fade p-2" id="statusupdate" role="tabpanel" aria-labelledby="statusupdate-tab"
                 [class.show.active]="currentTab === 'STATUS_UPDATE'"
                 [ngClass]="{ 'active': currentTab === 'STATUS_UPDATE' }">
                 <div class="mb-3">
                   <label class="fs-md fw-600">Observations</label>
                   <textarea class="form-control" rows="5" placeholder="Write here"
                     formControlName="observations"></textarea>
                 </div>

                 <div class="mb-3">
                   <!-- <label class="fs-md fw-600 mb-2">Approval Status</label> -->
                   <div class="form-check form-check-inline">
                     <input class="form-check-input" type="radio" formControlName="approvalStatus" id="reject"
                       value="Reject">
                     <label class="form-check-label" for="reject">Reject</label>
                   </div>
                   <div class="form-check form-check-inline">
                     <input class="form-check-input" type="radio" formControlName="approvalStatus" id="Accept"
                       value="Accept">
                     <label class="form-check-label" for="Accept">Accept</label>
                   </div>
                   <!-- <div class="form-check form-check-inline">
                     <input class="form-check-input" type="radio" formControlName="approvalStatus" id="furtherDetails"
                       value="Further Details Pending">
                     <label class="form-check-label" for="furtherDetails">Further Details Pending</label>
                   </div>
                   <div class="form-check form-check-inline">
                     <input class="form-check-input" type="radio" formControlName="approvalStatus"
                       id="forwardVerfication" value="Forward To Physical Verification">
                     <label class="form-check-label" for="forwardVerfication">Forward To Physical Verification</label>
                   </div> -->
                 </div>
                   <div class="mb-3">
                                  <div>
                                    <label for="uploadNoc" class="form-label text-center fw-600">Upload Diagnostic Report<span class="text-danger">*</span></label>
                                     <input class="form-control" id="uploadNoc" type="file" (change)="onFileSelected($event)" >
                                      <small *ngIf="diagnosticForm.get('urlForDiagnosticFile')?.value" class="text-muted">
                                        Uploaded file: {{ diagnosticForm.get('urlForDiagnosticFile')?.value?.split('/').pop() }}
                                      </small>
                                  </div>
                                </div>

                 <div class="text-end">
                   <button type="button" (click)="saveStatusUpdate()" class="btn btn-primary" *ngIf="freeze<=4">
                     Save Observations
                   </button>
                   <div *ngIf="saveSuccess.status" class="text-success small mt-2">
                     Observations Saved successfully!
                   </div>
                 </div>
                 <div class="text-end mt-3">
                   <input type="button" name="next" class="next btn btn-primary float-end" data-bs-toggle="modal" *ngIf="freeze<=4" [ngClass]="{'disabled': !diagnosticForm.get('urlForDiagnosticFile')?.value}"
                      data-bs-target="#approvedModal" data-bs-dismiss="modal" value="Submit For Manager Approval" />
                 </div>
               </div>
               <!-- Model of balance sheet -->


               <!-- end:: status update -->
             </div>
           </form>

         </div>
       </div>
     </div>
   </div>
   <!-- <input type="button" name="previous" class="previous btn btn-secondary float-start" value="Previous" /> -->
  
 </fieldset>



 <!-- begin:: add sharingholding pattern modal -->
 <!-- Shareholder Modal -->

 <div class="modal fade" [class.show]="showShareholderModal" [style.display]="showShareholderModal ? 'block' : 'none'"
   id="shareholdingPattern" tabindex="-1" aria-labelledby="shareholdingPatternLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
     <div class="modal-content">
       <div class="modal-header py-1 bg-theme">
         <h6 class="modal-title text-white"> {{ isEditMode ? 'Edit' : 'Add' }} Shareholding Pattern</h6>

         <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal" (click)="closeModal()"
           aria-label="Close"><span class="bi bi-x"></span> </button>
       </div>
       <div class="modal-body">
         <form [formGroup]="shareholderForm">
           <div class="row">
             <div class="col-12 ">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="shareholderName" formControlName="nameOfTheShareholder">
                 <label for="holderName">Share Holder Name <span class="text-danger">*</span></label>
               </div>
               <div
                 *ngIf="shareholderForm.get('nameOfTheShareholder')?.invalid && (shareholderForm.get('nameOfTheShareholder')?.dirty || shareholderForm.get('nameOfTheShareholder')?.touched)"
                 class="text-danger small">
                 Name is required
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="shareholderMobile" formControlName="position">
                 <label for="holderMobile">Position <span class="text-danger">*</span></label>
               </div>
               <div
                 *ngIf="shareholderForm.get('position')?.invalid && (shareholderForm.get('position')?.dirty || shareholderForm.get('position')?.touched)"
                 class="text-danger small">
                  Position is required
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="number" class="form-control" id="shareholderShares" formControlName="shareholdingPercentage">
                 <label for="holderShares">Percentage of Shares <span class="text-danger">*</span></label>
               </div>
               <div
                 *ngIf="shareholderForm.get('shareholdingPercentage')?.invalid && (shareholderForm.get('shareholdingPercentage')?.dirty || shareholderForm.get('shareholdingPercentage')?.touched)"
                 class="text-danger small">
                 Valid number required (minimum 1 && maximum 100)
               </div>
             </div>
           </div>
         </form>

         <div class="text-end">
           <button type="button" class="btn btn-secondary me-2" (click)="closeModal()">Cancel</button>
           <button type="button" class="btn btn-primary" (click)="saveShareholder()"
             [disabled]="shareholderForm.invalid">
             {{ isEditMode ? 'Update' : 'Save' }}
           </button>
         </div>
       </div>
     </div>
   </div>
 </div>
 <div class="modal-backdrop fade" [class.show]="showShareholderModal"
   [style.display]="showShareholderModal ? 'block' : 'none'"></div>
   <!-- Partnership model -->
   <div class="modal fade" [class.show]="showPartnershipModal" [style.display]="showPartnershipModal ? 'block' : 'none'"
   id="shareholdingPattern" tabindex="-1" aria-labelledby="shareholdingPatternLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
     <div class="modal-content">
       <div class="modal-header py-1 bg-theme">
         <h6 class="modal-title text-white"> {{ isEditModePartnership ? 'Edit' : 'Add' }} Partnership </h6>

         <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal" (click)="closePartnershipModal()"
           aria-label="Close"><span class="bi bi-x"></span> </button>
       </div>
       <div class="modal-body">
         <form [formGroup]="partnershipForm">
           <div class="row">
             <div class="col-12 ">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="shareholderName" formControlName="nameOfThePartner">
                 <label for="holderName">Name Of The Partner <span class="text-danger">*</span></label>
               </div>
               <div
                 *ngIf="partnershipForm.get('nameOfThePartner')?.invalid && (partnershipForm.get('nameOfThePartner')?.dirty || partnershipForm.get('nameOfThePartner')?.touched)"
                 class="text-danger small">
                 Name is required
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="shareholderMobile" formControlName="position">
                 <label for="holderMobile">Position <span class="text-danger">*</span></label>
               </div>
               <div
                 *ngIf="partnershipForm.get('position')?.invalid && (partnershipForm.get('position')?.dirty || partnershipForm.get('position')?.touched)"
                 class="text-danger small">
                  Position is required
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="number" class="form-control" id="shareholderShares" formControlName="profitSharingPercentage">
                 <label for="holderShares">Profit Sharing Percentage <span class="text-danger">*</span></label>
               </div>
               <div
                 *ngIf="partnershipForm.get('profitSharingPercentage')?.invalid && (partnershipForm.get('profitSharingPercentage')?.dirty || partnershipForm.get('profitSharingPercentage')?.touched)"
                 class="text-danger small">
                 Valid number required (minimum 1 && maximum 100)
               </div>
             </div>
           </div>
         </form>

         <div class="text-end">
           <button type="button" class="btn btn-secondary me-2" (click)="closePartnershipModal()">Cancel</button>
           <button type="button" class="btn btn-primary" (click)="savePartnership()"
             [disabled]="partnershipForm.invalid">
             {{ isEditModePartnership ? 'Update' : 'Save' }}
           </button>
         </div>
       </div>
     </div>
   </div>
 </div>
 <div class="modal-backdrop fade" [class.show]="showPartnershipModal"
   [style.display]="showPartnershipModal ? 'block' : 'none'"></div>

 <!-- begin:: add buyer modal -->
 <div class="modal fade" id="addBuyer" tabindex="-1" aria-labelledby="addBuyerLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg">
     <div class="modal-content">
       <div class="modal-header py-2">
         <h6 class="modal-title text-white" id="addResourceLabel">Add Buyer</h6>
         <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal" aria-label="Close"><span
             class="bi bi-x"></span></button>
       </div>
       <div class="modal-body">
         <form>
           <div class="row">
             <div class="col-12 col-sm-6 col-md-6 col-lg-6">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="buyername" placeholder="">
                 <label for="buyername">Buyer Name</label>
               </div>
             </div>
             <div class="col-12 col-sm-6 col-md-6 col-lg-6">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="qtypurchased" placeholder="">
                 <label for="qtypurchased">Qty Purchased</label>
               </div>
             </div>
             <div class="col-12 col-sm-6 col-md-6 col-lg-6">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="amt" placeholder="">
                 <label for="amt">Amount</label>
               </div>
             </div>
             <div class="col-12 col-sm-6 col-md-6 col-lg-6">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="remarks" placeholder="">
                 <label for="remarks">Remarks</label>
               </div>
             </div>
           </div>
         </form>

         <div class="text-end">
           <button type="button" class="btn btn-primary">Add</button>
         </div>
       </div>
     </div>
   </div>
 </div>

 <!-- begin:: add supplied modal -->
 <div class="modal fade" id="addSupplier" tabindex="-1" aria-labelledby="addSellerLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg">
     <div class="modal-content">
       <div class="modal-header py-2">
         <h6 class="modal-title text-white" id="addResourceLabel">Add Supplier</h6>
         <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal" aria-label="Close"><span
             class="bi bi-x"></span></button>
       </div>
       <div class="modal-body">
         <form>
           <div class="row">
             <div class="col-12 col-sm-6 col-md-6 col-lg-6">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="sellername" placeholder="">
                 <label for="sellername">Seller Name</label>
               </div>
             </div>
             <div class="col-12 col-sm-6 col-md-6 col-lg-6">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="suppliedQty" placeholder="">
                 <label for="suppliedQty">Suppplied Qty</label>
               </div>
             </div>
             <div class="col-12 col-sm-6 col-md-6 col-lg-6">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="amtSeller" placeholder="">
                 <label for="amtSeller">Amount</label>
               </div>
             </div>
             <div class="col-12 col-sm-6 col-md-6 col-lg-6">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="remarksSeller" placeholder="">
                 <label for="remarksSeller">Remarks</label>
               </div>
             </div>
           </div>
         </form>

         <div class="text-end">
           <button type="button" class="btn btn-primary">Add</button>
         </div>
       </div>
     </div>
   </div>
 </div>

 <!-- begin:: add order book position modal -->
 <div class="modal fade" id="orderBook" tabindex="-1" aria-labelledby="orderBookLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
     <div class="modal-content">
       <div class="modal-header py-1">
         <h6 class="modal-title text-white">Add Order Book Position</h6>
         <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal" aria-label="Close"><span
             class="bi bi-x"></span></button>
       </div>
       <div class="modal-body">
         <form>
           <div class="row">
             <div class="col-12 ">
               <div class="form-floating mb-3">
                 <input type="date" class="form-control" id="dateOrder" placeholder=""
                   max="{{ today | date:'yyyy-MM-dd' }}">
                 <label for="dateOrder">Date of Order</label>
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="customerName" placeholder="">
                 <label for="customerName">Customer Name</label>
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="orderValue" placeholder="">
                 <label for="orderValue">Order Value</label>
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="date" class="form-control" id="orderDelivery" placeholder=""
                   max="{{ today | date:'yyyy-MM-dd' }}">
                 <label for="orderDelivery">Order Delivery Date</label>
               </div>
             </div>
           </div>
         </form>

         <div class="text-end">
           <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Add</button>
         </div>
       </div>
     </div>
   </div>
 </div>

 <!-- begin:: add receivables modal -->
 <div class="modal fade" id="addReceivables" tabindex="-1" aria-labelledby="addReceivablesLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
     <div class="modal-content">
       <div class="modal-header py-1">
         <h6 class="modal-title text-white">Add Receivables</h6>
         <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal" aria-label="Close"><span
             class="bi bi-x"></span></button>
       </div>
       <div class="modal-body">
         <form>
           <div class="row">
             <div class="col-12 ">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="toReceived" placeholder="">
                 <label for="toReceived">To be received from</label>
               </div>
             </div>
             <!-- <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="date" class="form-control" id="receivableDate" placeholder="" max="{{ today | date:'yyyy-MM-dd' }}">
                 <label for="receivableDate">Receivable Date</label>
               </div>
             </div> -->
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="receivableAmount" placeholder="">
                 <label for="receivableAmount">Amount</label>
               </div>
             </div>
           </div>
         </form>

         <div class="text-end">
           <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Add</button>
         </div>
       </div>
     </div>
   </div>
 </div>

 <!-- begin:: add payables modal -->
 <div class="modal fade" id="addPayables" tabindex="-1" aria-labelledby="addPayablesLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
     <div class="modal-content">
       <div class="modal-header py-1">
         <h6 class="modal-title text-white">Add Payables</h6>
         <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal" aria-label="Close"><span
             class="bi bi-x"></span></button>
       </div>
       <div class="modal-body">
         <form>
           <div class="row">
             <div class="col-12 ">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="toPaid" placeholder="">
                 <label for="toPaid">To be Paid to</label>
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="date" class="form-control" id="payablesDate" placeholder=""
                   max="{{ today | date:'yyyy-MM-dd' }}">
                 <label for="payablesDate">Payable Date</label>
               </div>
             </div>
             <div class="col-12">
               <div class="form-floating mb-3">
                 <input type="text" class="form-control" id="payablesAmount" placeholder="">
                 <label for="payablesAmount">Payable Amount</label>
               </div>
             </div>
           </div>
         </form>

         <div class="text-end">
           <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Add</button>
         </div>
       </div>
     </div>
   </div>
 </div>
 <div class="modal fade" id="approvedModal" tabindex="-1" aria-labelledby="approvedModalLabel" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
     <div class="modal-content">
       <div class="modal-header py-2 bg-theme">
         <h6 class="modal-title text-white">Confirmation</h6>
         <button type="button" class="btn-close text-white fs-4 p-0" data-bs-dismiss="modal" aria-label="Close"><span
             class="bi bi-x"></span></button>
       </div>
       <div class="modal-body">
         <p class="text-center"> Are you sure you want to Proceed to Manager Approval. Once Saved it can't be revoked!
         </p>

         <div class="text-center">
           <button type="button" data-bs-toggle="modal" (click)="Approved()" class="btn btn-primary"
             data-bs-dismiss="modal">Yes</button>
           <button type="button" class="btn btn-danger ms-2" data-bs-dismiss="modal">No</button>
         </div>
       </div>
     </div>
   </div>
 </div>
